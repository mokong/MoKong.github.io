<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>iOS APP添加桌面快捷方式 | 今是昨非的博客</title><meta name="author" content="今是昨非"><meta name="copyright" content="今是昨非"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="iOS APP添加桌面快捷方式背景新接到一个需求，需要APP内的某些功能，能够把入口添加到桌面，点击桌面到入口可以直接跳转APP对应界面（类似于下面这张示例图），于是就做了一番调研。 其实很多APP目前都已经实现了类似的功能，比如支付宝、云闪付等等，其中的每一个独立功能都可以单独添加到桌面，所以网上有很多实现的方法，笔者做的是整理和试错。">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS APP添加桌面快捷方式">
<meta property="og:url" content="http://morganwang.cn/2021/05/06/iOS%20%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/index.html">
<meta property="og:site_name" content="今是昨非的博客">
<meta property="og:description" content="iOS APP添加桌面快捷方式背景新接到一个需求，需要APP内的某些功能，能够把入口添加到桌面，点击桌面到入口可以直接跳转APP对应界面（类似于下面这张示例图），于是就做了一番调研。 其实很多APP目前都已经实现了类似的功能，比如支付宝、云闪付等等，其中的每一个独立功能都可以单独添加到桌面，所以网上有很多实现的方法，笔者做的是整理和试错。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://morganwang.cn/assets/img/avatar.jpeg">
<meta property="article:published_time" content="2021-05-06T05:29:00.000Z">
<meta property="article:modified_time" content="2024-01-22T11:04:42.000Z">
<meta property="article:author" content="今是昨非">
<meta property="article:tag" content="技术">
<meta property="article:tag" content="iOS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://morganwang.cn/assets/img/avatar.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "iOS APP添加桌面快捷方式",
  "url": "http://morganwang.cn/2021/05/06/iOS%20%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/",
  "image": "http://morganwang.cn/assets/img/avatar.jpeg",
  "datePublished": "2021-05-06T05:29:00.000Z",
  "dateModified": "2024-01-22T11:04:42.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "今是昨非",
      "url": "http://morganwang.cn"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://morganwang.cn/2021/05/06/iOS%20%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'iOS APP添加桌面快捷方式',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">189</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1477346611705-65d1883cee1e);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">今是昨非的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">iOS APP添加桌面快捷方式</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">iOS APP添加桌面快捷方式</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-06T05:29:00.000Z" title="发表于 2021-05-06 13:29:00">2021-05-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-22T11:04:42.000Z" title="更新于 2024-01-22 19:04:42">2024-01-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="iOS-APP添加桌面快捷方式"><a href="#iOS-APP添加桌面快捷方式" class="headerlink" title="iOS APP添加桌面快捷方式"></a>iOS APP添加桌面快捷方式</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>新接到一个需求，需要APP内的某些功能，能够把入口添加到桌面，点击桌面到入口可以直接跳转APP对应界面（类似于下面这张示例图），于是就做了一番调研。</p>
<p>其实很多APP目前都已经实现了类似的功能，比如支付宝、云闪付等等，其中的每一个独立功能都可以单独添加到桌面，所以网上有很多实现的方法，笔者做的是整理和试错。</p>
<span id="more"></span>


<img src="https://i.loli.net/2021/04/22/wn137cohlfDUpKN.png" width="50%" height="50%">


<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>首先，添加到桌面功能的操作流程是：</p>
<p>客户端打开APP -&gt; 进入到对应到APP功能模块 -&gt; 点击添加快捷方式到桌面按钮 -&gt; 跳转浏览器，并加载引导页面，点击分享，选择添加到主屏幕 -&gt; 从主屏幕点击刚刚添加到快捷功能，跳转到APP的对应界面。</p>
<p><img src="https://i.loli.net/2021/04/22/H9hdM1rPgIvaEqc.png" alt="iOS开发内部功能生成桌面快捷方式.png"></p>
<p>根据笔者了解到的信息，目前实现这种功能，大致可以分为两种实现方式：</p>
<ul>
<li><p>方法一：H5提供网页，每个不同的功能提供不同的网页，服务端返回这些网页的URL，客户端配置打开URL Scheme，然后使用Safari直接加载URL，加载的网页中根据进入方式的不同，自动重定向打开APP的URL Scheme。</p>
</li>
<li><p>方法二：H5提供通用的网页，客户端替换通用网页中的内容，比如标题、图标等，并转为DataURI格式，服务端提供接口URL，客户端配置打开URL Scheme，使用Safari加载，接口返回强制重定向加载DataURI数据</p>
<blockquote>
<p>其中方法二还有另一种实现方式，即客户端使用HttpServer模拟服务端。但笔者看来，无论是服务端返回URL还是客户端使用HttpServer，其实是服务端的不同实现方式，故而没有单独分类。</p>
</blockquote>
</li>
</ul>
<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p><strong>第一步</strong> 客户端：iOS 打开已有Xcode项目，选中Target，添加URL Scheme，这个URL Scheme是自己定义的，在这个地方定义了xxx之后，可以通过在浏览器中输入xxx://来唤起APP，比如笔者定义了一个mkaddtohomescreen，然后在浏览器中输入mkaddtohomescreen://，就会弹出是否打开对应APP的提示</p>
<img src="https://i.loli.net/2021/04/23/Un47sFZaxi6GJC5.png" width="80%" height="80%">



<img src="https://i.loli.net/2021/04/23/W4zIUYMdHluxS3A.png" width="50%" height="50%">



<p>定义好了Scheme之后，可以考虑Scheme添加参数的问题，通过在scheme后添加参数，在Appdelegate中<code>applicaiton:open:options:</code>方法拦截到，根据对应参数跳转不同界面</p>
<blockquote>
<p>比如Scheme为<code>mkaddtohomescreen://page/view1</code>，在<code>applicaiton:open:options:</code>中，<code>url.absouluteString = mkaddtohomescreen://page/view1，url.host = page，url.path = /view1，</code>所以可以根据path的不同跳转不同的界面。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span>(<span class="keyword">_</span> <span class="params">app</span>: <span class="type">UIApplication</span>, <span class="params">open</span> <span class="params">url</span>: <span class="type">URL</span>, <span class="params">options</span>: [<span class="type">UIApplication</span>.<span class="params">OpenURLOptionsKey</span> : <span class="keyword">Any</span>] <span class="operator">=</span> [:])</span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> navController <span class="operator">=</span> window<span class="operator">?</span>.rootViewController <span class="keyword">as?</span> <span class="type">UINavigationController</span>,</span><br><span class="line">        <span class="keyword">let</span> topController <span class="operator">=</span> navController.topViewController &#123;</span><br><span class="line">        <span class="comment">// eg: mkaddtohomescreen://page/view1</span></span><br><span class="line">        <span class="comment">// url.host = page</span></span><br><span class="line">        <span class="comment">// url.path = /view1</span></span><br><span class="line">        <span class="keyword">if</span> url.absoluteString.hasPrefix(<span class="string">&quot;mkaddtohomescreen://&quot;</span>) &#123;</span><br><span class="line">            <span class="comment">// 说明是APP的URL Scheme，处理</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> targetVC <span class="operator">=</span> targetViewController(from: url.path)</span><br><span class="line">            <span class="keyword">if</span> targetVC <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">                <span class="comment">// 判断当前显示的界面是否是要跳转的界面</span></span><br><span class="line">                <span class="keyword">if</span> topController.classForCoder <span class="operator">==</span> targetVC<span class="operator">?</span>.classForCoder &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                navController.pushViewController(targetVC<span class="operator">!</span>, animated: <span class="literal">true</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据URL path返回要跳转的界面</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">targetViewController</span>(<span class="params">from</span> <span class="params">path</span>: <span class="type">String</span>)</span> -&gt; <span class="type">UIViewController</span>? &#123;</span><br><span class="line">    <span class="keyword">var</span> targetVC: <span class="type">UIViewController</span>?</span><br><span class="line">    <span class="keyword">switch</span> path &#123;</span><br><span class="line">    <span class="comment">// 根据URL的path跳转不同路径</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/view1&quot;</span>:</span><br><span class="line">        targetVC <span class="operator">=</span> <span class="type">Method1ViewController</span>()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/view2&quot;</span>:</span><br><span class="line">        targetVC <span class="operator">=</span> <span class="type">Method2ViewController</span>()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/view3&quot;</span>:</span><br><span class="line">        targetVC <span class="operator">=</span> <span class="type">Method3ViewController</span>()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        targetVC <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> targetVC</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>第二步</strong> H5参考<a target="_blank" rel="noopener" href="https://github.com/DarielChen/iOSTips/tree/master/Demo/47.%E7%BB%99App%E7%9A%84%E6%9F%90%E4%B8%AA%E5%8A%9F%E8%83%BD%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F">47.给App的某个功能添加快捷方式</a><br>中的shortcuts.html，其中共有三部分，大致为：</p>
<ul>
<li>header部分定义了网页的标题，以及显示到桌面快捷方式的图标和标题</li>
<li>body部分则定义来这个网页的内容，其实是引导用户如何添加到桌面</li>
<li>script部分则是做了一个判断，判断是桌面快捷方式进入的情况，自己调用redirect</li>
</ul>
<p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-capable&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#ffffff&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-title&quot;</span> <span class="attr">content</span>=<span class="string">&quot;\(title)&quot;</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon-precomposed&quot;</span> <span class="attr">href</span>=<span class="string">&quot;data:image/jpeg;base64,\(feature_icon)&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>\(title)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.documentElement.style.fontSize = <span class="number">100</span> * <span class="built_in">document</span>.documentElement.clientWidth / <span class="number">375</span> + <span class="string">&quot;px&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">       <span class="comment">/* css代码见链接 https://github.com/mokong/WKAddToHomeScreen */</span></span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;redirect&quot;</span> <span class="attr">href</span>=<span class="string">&quot;\(urlToRedirect.absoluteString)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;subject&quot;</span>&gt;</span>添加快捷功能到桌面<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;guide&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">                    点击下方工具栏上的<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/XEbFrgamEdvSxVFOBeuZ.png&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">                        并选择<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/IkKEhyTLQpYtqXMZBYtQ.png&quot;</span>&gt;</span>“<span class="tag">&lt;<span class="name">strong</span>&gt;</span>添加到主屏幕<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>”</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/oFNuXVhPJYvBDJPXJTmt.jpg&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;arrow&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/FlBEnTRnlhMyLyVhlfZT.png&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.standalone) &#123;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        element.style.display = <span class="string">&quot;none&quot;</span>;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;redirect&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;MouseEvents&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        event.initEvent(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">document</span>.defaultView, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; element.dispatchEvent(event); &#125;, <span class="number">25</span>);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        element.style.display = <span class="string">&quot;inline&quot;</span>;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中有关于涉及到桌面快捷方式图标和标题设置的解释可参考苹果官方的<a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html">Configuring Web Applications</a>，如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Specifying a Webpage Icon for Web Clip --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;touch-icon-iphone.png&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- apple-touch-icon-precomposed与apple-touch-icon的区别为前者是原图，后者是会被苹果处理的图片，这两个的使用二选一即可</span></span><br><span class="line"><span class="comment">&lt;link rel=&quot;apple-touch-icon-precomposed&quot; href=&quot;xxx.png&quot;&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Specifying a Launch Screen Image --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-startup-image&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/launch.png&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Adding a Launch Icon Title --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-title&quot;</span> <span class="attr">content</span>=<span class="string">&quot;AppTitle&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Hiding Safari User Interface Components --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-capable&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Changing the Status Bar Appearance&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="attr">content</span>=<span class="string">&quot;black&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Linking to Other Native Apps --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;tel:1-408-555-5555&quot;</span>&gt;</span>Call me<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>H5提供网页，比如上面示例的代码，然后把其中header部分的内容设置为固定的</p>
<ul>
<li>“apple-mobile-web-app-title”是桌面快捷方式的标题</li>
<li>“apple-touch-icon-precomposed”是桌面快捷方式的图片，其中的格式可以选择使用DataURI的这种样式，生成方法可以参考下面的</li>
<li>“title”则是页面的标题</li>
<li>\(urlToRedirect.absoluteString)是定义好的URL Scheme链接</li>
</ul>
<p>获取图片DataURI格式的数据Swift的代码如下</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 获取图片DataURI格式的数据</span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> iconData <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;homeScreen&quot;</span>)<span class="operator">?</span>.jpegData(compressionQuality: <span class="number">0.5</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> iconDataURI <span class="operator">=</span> iconData.base64EncodedString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>具体步骤如下：</p>
<ol>
<li><p>配置好客户端的URLScheme</p>
</li>
<li><p>H5提供编写好的网页，如果没有H5，可使用上面的shortcuts.html内容，把其中的待替换字段\(title)、\(feature_icon)、以及\(urlToRedirect.absoluteString)设置为自己APP的，其中的apple-touch-icon-precomposed需要放图标经过DataURI后的String</p>
</li>
<li><p>需要服务端提供URL，返回这个网页，然后客户端打开这个URL。如果服务端也没有。。。那就跟我一样，使用模拟接口返回，打开<a target="_blank" rel="noopener" href="https://designer.mocky.io/design">mocky</a>，(可能需要注册)，Response Content Type 设置为text/html，HTTP Response Body 中放入下面的网页内容，然后点击底部的GENERATE MY HTTP RESPONSE，就会生成一个URL</p>
<img src="https://i.loli.net/2021/04/23/PIuayL3t28WJVOi.png" width="80%" height="80%" /></li>
<li><p>在点击添加快捷方式的地方，直接openURL即可</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addMethod1</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="keyword">Any</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 方法一，不需要本地放H5数据，只需要打开指定URL即可</span></span><br><span class="line">    <span class="comment">// 可使用mocky来提供模拟接口</span></span><br><span class="line">    <span class="keyword">let</span> urlStr <span class="operator">=</span> <span class="string">&quot;https://run.mocky.io/v3/98baaf4a-edec-4956-8506-7bbfca349d07&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">UIApplication</span>.shared.open(<span class="type">URL</span>(string: urlStr)<span class="operator">!</span>, options: [:], completionHandler: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>可参考<a target="_blank" rel="noopener" href="https://github.com/DarielChen/iOSTips/tree/master/Demo/47.%E7%BB%99App%E7%9A%84%E6%9F%90%E4%B8%AA%E5%8A%9F%E8%83%BD%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F">给App的某个功能添加快捷方式</a>，文章中使用的是客户端自建服务器返回DataURI数据的方法，具体操作如下：</p>
<ol>
<li><p>配置好客户端的URL Schemes</p>
</li>
<li><p>客户端使用Pod添加Swifter，用于自建服务器</p>
</li>
<li><p>H5提供编写好的网页，使用上面的shortcuts.html内容，其中的待替换字段不要动</p>
</li>
<li><p>在点击添加快捷方式时，客户端读取html的内容并替换里面指定字段，转为DataURI，启动本地服务器，并返回DataURI数据</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addMethod2</span>(<span class="keyword">_</span> <span class="params">sender</span>: <span class="keyword">Any</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 定义好的URL Scheme</span></span><br><span class="line">        <span class="keyword">let</span> schemeStr <span class="operator">=</span> <span class="string">&quot;mkaddtohomescreen://page/view2&quot;</span></span><br><span class="line">        <span class="comment">// 要替换的桌面快捷方式图标</span></span><br><span class="line">        <span class="keyword">let</span> shortcutImageData <span class="operator">=</span> <span class="type">UIImage</span>(named: <span class="string">&quot;homescreen&quot;</span>)<span class="operator">?</span>.jpegData(compressionQuality: <span class="number">0.5</span>)</span><br><span class="line">        <span class="comment">// 要替换的桌面快捷方式标题</span></span><br><span class="line">        <span class="keyword">let</span> shortcutTitle <span class="operator">=</span> <span class="string">&quot;添加到主屏幕2&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span>  <span class="keyword">let</span> schemeURL <span class="operator">=</span> <span class="type">URL</span>(string: schemeStr),</span><br><span class="line">               <span class="keyword">let</span> shortcutImageStr <span class="operator">=</span> shortcutImageData<span class="operator">?</span>.base64EncodedString() <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 替换H5中的内容</span></span><br><span class="line">        <span class="keyword">let</span> htmlStr <span class="operator">=</span> htmlFor(title: shortcutTitle, urlToRedirect: schemeURL.absoluteString, icon: shortcutImageStr)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> base64 <span class="operator">=</span> htmlStr.data(using: .utf8)<span class="operator">?</span>.base64EncodedString() <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启动本地服务器，端口号是9081</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> shortcutUrl <span class="operator">=</span> <span class="type">URL</span>(string: <span class="string">&quot;http://localhost:9081/s&quot;</span>) &#123;</span><br><span class="line">            <span class="comment">// 转为dataURI格式</span></span><br><span class="line">            <span class="keyword">let</span> server <span class="operator">=</span> <span class="type">HttpServer</span>()</span><br><span class="line">            server[<span class="string">&quot;/s&quot;</span>] <span class="operator">=</span> &#123; request <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> .movedPermanently(<span class="string">&quot;data:text/html;base64,<span class="subst">\(base64)</span>&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try?</span> server.start(<span class="number">9081</span>)</span><br><span class="line">            <span class="type">UIApplication</span>.shared.open(shortcutUrl, options: [:], completionHandler: <span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">htmlFor</span>(<span class="params">title</span>: <span class="type">String</span>, <span class="params">urlToRedirect</span>: <span class="type">String</span>, <span class="params">icon</span>: <span class="type">String</span>)</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> shortcutsPath <span class="operator">=</span> <span class="type">Bundle</span>.main.path(forResource: <span class="string">&quot;content2&quot;</span>, ofType: <span class="string">&quot;html&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> shortcutsContent <span class="operator">=</span> <span class="keyword">try!</span> <span class="type">String</span>(contentsOfFile: shortcutsPath<span class="operator">!</span>) <span class="keyword">as</span> <span class="type">String</span></span><br><span class="line">        shortcutsContent <span class="operator">=</span> shortcutsContent.replacingOccurrences(of: <span class="string">&quot;<span class="subst">\\</span>(title)&quot;</span>, with: title)</span><br><span class="line">        shortcutsContent <span class="operator">=</span> shortcutsContent.replacingOccurrences(of: <span class="string">&quot;<span class="subst">\\</span>(urlToRedirect.absoluteString)&quot;</span>, with: urlToRedirect)</span><br><span class="line">        shortcutsContent <span class="operator">=</span> shortcutsContent.replacingOccurrences(of: <span class="string">&quot;<span class="subst">\\</span>(feature_icon)&quot;</span>, with: icon)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(shortcutsContent)</span><br><span class="line">        <span class="keyword">return</span> shortcutsContent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="还没完"><a href="#还没完" class="headerlink" title="还没完"></a>还没完</h3><p>代码放到了<a target="_blank" rel="noopener" href="https://github.com/mokong/WKAddToHomeScreen">Github</a>，大家下载运行后会发现还有一个问题待解决，即：当使用方法一，添加快捷标签到桌面后，第一次点击桌面的快捷标签打开了APP；再次点击桌面的快捷标签，显示白屏，原因是第一次打开快捷标签没有关闭，重新打开时没有触发加载，所以也就没有跳转APP。而使用了DataURI加载的方法二，则没有这个问题，每次点击图标均可以直接跳转。</p>
<p>但是对比支付宝的添加到桌面发现支付宝的也是采用的方法一，第一次从桌面添加的快捷打开时自动跳转到支付宝，第二次点击桌面到快捷图标时，发现也是停留在一个页面，但是支付宝在这个页面上放了东西，可以称之为中间页。如下</p>
<img src="https://i.loli.net/2021/04/23/A9QaIjZ8HN1xD7O.png" width="50%" height="50%">

<p>要怎么实现中间页那种效果呢，目前笔者方法一的实现，点击时依赖的是服务端返回的H5网页内容，里面的Script会根据进入方式的不同，直接自跳转打开APP的URL Scheme；所以想要添加中间页，嗯，想法是：嵌套一层。即：</p>
<ul>
<li>服务端返回的H5网页内容，里面的Script不直接跳转打开APP的URL Scheme，而是跳转中间页的链接</li>
<li>中间页的页面，同样的逻辑，再次跳转打开APP的URLScheme；同时中间页的页面添加按钮，点击也是跳转APP的URLScheme。<br>这样，第一次点击时，是桌面-中间页-APP的URL Scheme；第二次点击时，则是直接显示中间页，然后手动点击中间页上的立即进入，再次打开APP。</li>
</ul>
<p>下面来尝试一下：<br>首先编辑中间页面的H5，大致内容如下，仅供参考。。。。就是把之前H5页面的body部分简单修改一下，添加一个button，事件是点击打开Scheme，同时自动跳转Scheme的逻辑也还存在。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-capable&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#ffffff&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-title&quot;</span> <span class="attr">content</span>=<span class="string">&quot;方法三中间页内容&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&quot;方法三中间页标题&quot;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.documentElement.style.fontSize = <span class="number">100</span> * <span class="built_in">document</span>.documentElement.clientWidth / <span class="number">375</span> + <span class="string">&quot;px&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">          <span class="comment">/* css代码见链接 https://github.com/mokong/WKAddToHomeScreen */</span></span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;redirect&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mkaddtohomescreen://page/view3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;B_container&quot;</span> <span class="attr">class</span>=<span class="string">&quot;backguide&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: block; width=&#x27;100%&#x27;; background-color=#cyan&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span>你即将进入<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;B_icon&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;B_appname&quot;</span> <span class="attr">class</span>=<span class="string">&quot;appname&quot;</span>&gt;</span>MKAddToHomeScreen<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;enter&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;jumpSchema()&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #red; widht=100%; height=64px&quot;</span>&gt;</span>立即进入<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">jumpSchema</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;redirect&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;MouseEvents&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        event.initEvent(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">document</span>.defaultView, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; element.dispatchEvent(event); &#125;, <span class="number">25</span>);</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.standalone) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;redirect&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;MouseEvents&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        event.initEvent(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">document</span>.defaultView, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; element.dispatchEvent(event); &#125;, <span class="number">25</span>);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        element.style.display = <span class="string">&quot;inline&quot;</span>;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>把中间页的网页放到<a target="_blank" rel="noopener" href="https://designer.mocky.io/design">mocky</a>中按照同样的方式(Response Content Type 设置为text/html，HTTP Response Body 中放入网页内容)，生成一个URL，然后把这个URL放到之前网页要自跳转的href中，然后再把之前网页再用<a target="_blank" rel="noopener" href="https://designer.mocky.io/design">mocky</a>生成一个链接，在APP中使用openURL的方式打开最后生成的这个链接，运行，调试。</p>
<p>发现结果是期望的，即第一次打开直接跳转，第二次打开显示中间页上面有点击跳转按钮；但是中间页的样式看起来确跟支付宝的不一样，这样生成的中间页因为经过了一次跳转，所以顶部和底部都显示了Safari二级页面的样式，嗯哼，这个不是笔者所希望的效果，而且体验支付宝的效果之后，发现支付宝的中间页是没有二级页面的那种头部和底部的，所以，那是怎么实现的呢？</p>
<img src="https://i.loli.net/2021/04/29/2hGU6u1YcgtkApz.jpg" width="50%" height="50%">

<p>如果不想要中间页显示为二级页面的形式，就不能采用上面那种经过一次跳转方法。只能采用单一页面的方法，在一个H5页面上想办法。所以现在想要的是，在同一个页面上，从APP跳转的时候显示“引导添加到桌面”的样式，从桌面打开时显示“中间页”的样式。</p>
<p>按照这个逻辑来，用两个div，包括两段样式，根据进入方式的不同，设置两个div的显示隐藏是不是就可以了呢？说做就做，把上面第二个html中的内容和样式放到第一个html中，代码如下：middle_container是中间页的div，jump_container是引导页div，然后根据window.navigator.standalone判断显示哪一个div，middle_container中按钮点击是跳转打开APP，同时再把第一个html的跳转由跳转中间页改为打开APP</p>
<p>Ps:</p>
<blockquote>
<p>要检测Web应用程序当前是否运行在全屏状态，只要检测window.navigator.standalone是否为true就可以了，如果这个属性为true则表示Web应用程序当前运行在全屏状态，否则运行在非全屏状态。可用于检测到Web应用程序运行在非全屏状态时提示用户把Web应用程序的图标添加到主屏幕。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-capable&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#ffffff&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-title&quot;</span> <span class="attr">content</span>=<span class="string">&quot;方法三标题&quot;</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon-precomposed&quot;</span> <span class="attr">href</span>=<span class="string">&quot;data:image/jpeg;base64,imageData&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>方法三网页标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.documentElement.style.fontSize = <span class="number">100</span> * <span class="built_in">document</span>.documentElement.clientWidth / <span class="number">375</span> + <span class="string">&quot;px&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">       <span class="comment">/* css代码见链接 https://github.com/mokong/WKAddToHomeScreen */</span></span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;redirect&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mkaddtohomescreen://page/view3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;middle_container&quot;</span> <span class="attr">class</span>=<span class="string">&quot;backguide&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle_tips&quot;</span>&gt;</span>你即将进入<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;middle_icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;middle_appname&quot;</span>&gt;</span>MKAddToHomeScreen<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;middle_enter&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;jumpSchema()&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: #red; widht=100%; height=64px&quot;</span>&gt;</span>立即进入<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;jump_container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;subject&quot;</span>&gt;</span>添加快捷功能到桌面<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;guide&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">                    点击下方工具栏上的<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/XEbFrgamEdvSxVFOBeuZ.png&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">                        并选择<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/IkKEhyTLQpYtqXMZBYtQ.png&quot;</span>&gt;</span>“<span class="tag">&lt;<span class="name">strong</span>&gt;</span>添加到主屏幕<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>”</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/oFNuXVhPJYvBDJPXJTmt.jpg&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;arrow&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://dariel-1256714552.cos.ap-shanghai.myqcloud.com/FlBEnTRnlhMyLyVhlfZT.png&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">jumpSchema</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;redirect&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;MouseEvents&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        event.initEvent(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">document</span>.defaultView, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; element.dispatchEvent(event); &#125;, <span class="number">25</span>);</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.standalone) &#123;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> middle_element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;middle_container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> jump_element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;jump_container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        middle_element.style.display = <span class="string">&quot;inline&quot;</span>;</span></span><br><span class="line"><span class="javascript">        jump_element.style.display = <span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;redirect&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> event = <span class="built_in">document</span>.createEvent(<span class="string">&#x27;MouseEvents&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        event.initEvent(<span class="string">&#x27;click&#x27;</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">document</span>.defaultView, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">0</span>, <span class="literal">null</span>);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.body.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; element.dispatchEvent(event); &#125;, <span class="number">25</span>);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> middle_element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;middle_container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> jump_element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;jump_container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        </span></span><br><span class="line"><span class="javascript">        middle_element.style.display = <span class="string">&quot;none&quot;</span>;</span></span><br><span class="line"><span class="javascript">        jump_element.style.display = <span class="string">&quot;inline&quot;</span>;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后用当前内容放到<a target="_blank" rel="noopener" href="https://designer.mocky.io/design">mocky</a>生成一个链接，在程序中打开这个链接，体验，Binggo。没有了二级界面的样式，而且再次打开，页面显示也不是空白，而是如下样式：</p>
<img src="https://i.loli.net/2021/04/29/QRFYdJX9N2tSquj.png" width="50%" height="50%">




<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>完整代码在：<a target="_blank" rel="noopener" href="https://github.com/mokong/WKAddToHomeScreen">Github</a>。</p>
<p>笔者感觉两种方式各有优缺点：方法一依赖于网络，因为需要服务端返回的网页内容，加载完成后才能进行下一步跳转。而方法二采用DataURI方式的，把数据已经转为string放在了本地，点击时直接加载，故而不依赖网络。但方法一实现简单，客户端、H5、和服务端配合虽然有些冗余，但工作量小，很容易实现。方法二的加载采用DataURI，查看调试数据不方便。根据笔者的观察，支付宝其实采用的是方法二，没网络的时候也可以加载打开主APP，且在方法二的基础上还加上了中间页。</p>
<p>附图：</p>
<img src="https://i.loli.net/2021/04/23/ACd5wtVjEFXWpqD.png" width="90%" height="90%">


<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/9fb0824f95fe">iOS开发 将App内部功能块生成桌面快捷方式</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cocoachina.com/articles/26570">给App的某个功能添加桌面快捷方式</a></li>
<li><a target="_blank" rel="noopener" href="https://wayshon.com/2019/ios-app%E5%86%85%E9%A1%B5%E9%9D%A2%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%A1%8C%E9%9D%A2.html">ios app内页面添加到桌面</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2579ad49e11c">ios 关于支付宝添加桌面快捷方式的探究</a></li>
<li><a target="_blank" rel="noopener" href="https://designer.mocky.io/design">模拟接口返回</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://morganwang.cn">今是昨非</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://morganwang.cn/2021/05/06/iOS%20%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/">http://morganwang.cn/2021/05/06/iOS%20%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://morganwang.cn" target="_blank">今是昨非的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8A%80%E6%9C%AF/">技术</a><a class="post-meta__tags" href="/tags/iOS/">iOS</a></div><div class="post-share"><div class="social-share" data-image="/assets/img/avatar.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2021/05/12/iOS%20mach-o%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%9A%E4%BD%99%E7%9A%84%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/" title="iOS mach-o文件分析多余的类和方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">iOS mach-o文件分析多余的类和方法</div></div><div class="info-2"><div class="info-item-1">mach-o文件分析多余的类和方法.md背景最近做包大小优化，在做项目代码优化时，其中有一个过程是分析Mach-O文件，看网上很多文章都说通过otool分析Mach-O，获取__objc_classrefs、__objc_classlist等，然后找出无用类和无用方法。   比如：无用类通过 otool 逆向Mach-O文件 __DATA.__objc_classlist段和__DATA.__objc_classrefs 段获取所有 OC 类和被引用的类，两个集合差值为无用类集合，结合 nm -nm 得到地址和对应类名符号化无用类类名来自干货！京东商城iOS App瘦身实践 又或者结合LinkMap文件的__TEXT.__text，通过正则表达式([+|-][.+\s(.+)])，我们可以提取当前可执行文件里所有objc类方法和实例方法（SelectorsAll）。再使用otool命令otool -v -s __DATA __objc_selrefs逆向__DATA.__objc_selrefs段，提取可执行文件里引用到的方法名（UsedSelectorsAll），我们可以大致分...</div></div></div></a><a class="pagination-related" href="/2021/04/21/iOS%20%E5%88%A0%E9%99%A4SceneDelegate%E5%92%8CStoryboard/" title="iOS 删除新创建项目中的SceneDelegate"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">iOS 删除新创建项目中的SceneDelegate</div></div><div class="info-2"><div class="info-item-1">iOS 删除新创建项目中的SceneDelegate背景Xcode 11之后新建工程，默认为有SceneDelegate，但是SceneDelegate是从iOS 13之后才有的，如果最低兼容版本到iOS 13以下，需要怎么做呢？   过程首先来看一下，SceneDelegate是什么，为什么会有SceneDelegate 官方说明：  A UISceneSession object manages a unique runtime instance of your scene. When the user adds a new scene to your app, or when you request one programmatically, the system creates a session object to track that scene. The session contains a unique identifier and the configuration details of the scene. UIKit maintains the sessio...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2020/07/12/iOS%2014%E9%80%82%E9%85%8D%E2%80%94%E2%80%94%E6%9F%A5%E6%89%BE%E5%93%AA%E4%BA%9BSDK%E4%BD%BF%E7%94%A8%E5%89%AA%E5%88%87%E6%9D%BF/" title="iOS14适配一查找哪些SDK使用剪切板"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-12</div><div class="info-item-2">iOS14适配一查找哪些SDK使用剪切板</div></div><div class="info-2"><div class="info-item-1">iOS14适配一查找哪些SDK使用剪切板背景iOS14公测版发出之后，我们app出现了从后台唤起会弹出 读取剪切板的 提示，安全要求要赶紧查，全局搜索了我们APP，发现并没有读取剪切板的代码，比窦娥还冤，只能是第三方SDK的问题了，但是项目里集成了十几个第三方SDK，一个个排查删除，万一两个SDK都有，这个排列组合可能性就太多了。   脑壳疼了好几天，求助万能的V友和群友，然后找到了好的办法  步骤1: 用Xcode的Symbolic breakpoint，调试[UIPasteboard generalPasteboard]，按照重现步骤，例如，我们APP是从后台唤起来会有这个提示，就打断点，然后走这个流程。     步骤2: 断点会停在调用到这个方法的地方，然后上下查看，如果还不能确认是哪个SDK的话，就单步向下走几步，然后就会出现调用方     步骤3:具体调用的类已经暴露了之后，怎么确定这是哪个SDK的呢？在工程目录中使用命令（来自群友的帮助）：12find . -type f | grep -e &quot;.framework&quot; | xargs grep -s...</div></div></div></a><a class="pagination-related" href="/2023/03/22/iOS%E6%8E%A8%E9%80%81%E8%AF%AD%E9%9F%B3%E6%92%AD%E6%8A%A5%E6%9B%B4%E6%96%B0/" title="iOS推送播放语音播报更新"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-22</div><div class="info-item-2">iOS推送播放语音播报更新</div></div><div class="info-2"><div class="info-item-1">iOS推送播放语音播报更新接上篇如何让iOS推送播放语音，之前的结论是iOS如果需要送审商店只能播放本地的mp3文件，这里更新一下：   更新语音的播放，最终调用的方法是UNNotificationSound(named: xxx)，而这个方法官方文档注释如下： 12// The sound file to be played for the notification. The sound must be in the Library/Sounds folder of the app&#x27;s data container or the Library/Sounds folder of an app group data container. If the file is not found in a container, the system will look in the app&#x27;s bundle.    public convenience init(named name: UNNotificationSoundName)  注释里说，语音文件会从这三个地方...</div></div></div></a><a class="pagination-related" href="/2022/12/12/iOSAPP%E9%BB%91%E7%99%BD%E5%AE%9E%E7%8E%B0/" title="iOS界面黑白实现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-12</div><div class="info-item-2">iOS界面黑白实现</div></div><div class="info-2"><div class="info-item-1">背景iOS APP界面黑白效果实现调研整理，总的来说网上目前有下面几种方法：   针对H5网页：注入js代码 针对APP原生界面： 针对图片和颜色单独设置 hook UIImageView的setImage方法，添加UIImage的Category，生成灰色图片 hook UIColor的colorWithRed:green:blue:alpha:方法   针对界面整体处理 创建一个灰色view，设置不响应事件，然后添加在window最上层 给App整体添加灰色滤镜      具体如下： 实现针对网页：针对网页的处理：  如果有基类，可以直接在基类初始化WKWebview的地方，添加如下代码： 123456WKWebViewConfiguration *config = [[WKWebViewConfiguration alloc] init];// js脚本NSString *jScript = @&quot;var filter = &#x27;-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%); -ms-fi...</div></div></div></a><a class="pagination-related" href="/2022/06/11/iOS%20The%20'Pods-App'%20target%20has%20transitive%20dependencies%20that%20include%20static%20binaries/" title="The &#39;Pods-App&#39; target has transitive dependencies that include static binaries"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-11</div><div class="info-item-2">The &#39;Pods-App&#39; target has transitive dependencies that include static binaries</div></div><div class="info-2"><div class="info-item-1">The ‘Pods-App’ target has transitive dependencies that include static binaries:修改背景最近遇到了两次次这个问题，都是Swift项目Pod添加库开启了use_frameworks!，安装某些OC库时报错；花了好久时间解决，突然想起来之前OC项目安装Swift库也遇到了这个问题，但是之前没有记录，所以这次遇到时没有印象；这次记录下来，分享给大家：   解决方案之前遇到的是OC代码安装ZLPhotoBrowser的Swift库，开启了use_frameworks!，和其他第三方库一起安装时，可以理解为，除了ZLPhotoBrowser是动态库，其他的第三方库默认都使用static_framework或者static_library。 Pod文件末尾添加下面代码： 12345678910111213141516171819use_frameworks!...dynamic_frameworks = [&#x27;ZLPhotoBrowser&#x27;]pre_install do |installer|  ...</div></div></div></a><a class="pagination-related" href="/2024/06/07/Safari%20%E8%8E%B7%E5%8F%96%20Bing%20Rewards%20%E6%8F%92%E4%BB%B6/" title="Safari 获取 Bing Rewards 插件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-07</div><div class="info-item-2">Safari 获取 Bing Rewards 插件</div></div><div class="info-2"><div class="info-item-1">背景Bing Rewards 可以兑换天猫礼品卡、中国石化礼品卡、肯德基电子券、盒马礼品卡、苹果礼品卡等。level 1 的时候每天至多获取 30 积分，level 2 的可以电脑端 90积分、手机端60 积分。每天150 积分点着太累了，就想着有没有一键的便捷操作。    找到了一个通过 Chrome 插件Rewards-Search-Automator: Chrome / Edge extension for automatic Bing Search，来实现的，除去其中的 Mobile 不生效，外加搜索完成跳转开发者的网站，别的还好，可以自己下载代码，修改去掉跳转开发者网站的逻辑。 但是就是还有个问题，在 iPhone 上用不了，所以手机端的 60 积分还是不能一键获取，所以就想到了，借鉴这个做个 Safari 插件，然后就可以在iPhone上用了。 实现逻辑很简单，iPhone 使用 Bing 搜索，然后抓包出请求，然后提取出关键的form，再封装到 Safari Extension 中，当 popup 出来的时候，触发搜索。添加生成随机字符串的逻辑，每隔 6 秒，重新搜...</div></div></div></a><a class="pagination-related" href="/2022/05/23/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9mac%E5%BA%94%E7%94%A8%E5%88%9B%E5%BB%BA/" title="图片压缩 mac 应用开发"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-23</div><div class="info-item-2">图片压缩 mac 应用开发</div></div><div class="info-2"><div class="info-item-1">图片压缩 mac 应用开发背景3年前有个项目BatchProssImage，使用 Python 写的批量压缩图片的，最新再次使用时，发现忘记了怎么使用，所以就有了把这个Python 实现的工具，做成一个简单的 mac app 的想法。   过程想法很简单：印象中当时这个工具是使用 tinypng 的 api 压缩的，所以开发一个 mac客户端，调用压缩的接口，导出照片就可以。开始动工。 首先 mac 客户端的 UI 从哪里来？之前有个项目OtoolAnalyse——分析Mach-O文件中无用的类和方法，是借LinkMapUI 来实现的。这里想了想，嗯，还可以用这个方法。打开项目一看，OC 的，还是用 Swift 写一遍吧。 UI 实现想一下大致需要哪些功能，  选择文件 || 目录 选择导出目录 开始压缩 压缩进度显示 噢噢，还有一个，tinypng apikey 输入  再考虑一下，选择导出目录是否必要？之前笔者自己使用其他 APP 选择导出时，打断先有的操作且不说，对于选择困难来说，每次考虑要导出到哪里都是一个问题，要不要新建一个文件夹，还选择同目录会是什么效果等等。 改为 ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">今是昨非</div><div class="author-info-description">技术分享、生活感悟</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">189</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mokong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/mokong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://x.com/morgan2015_wang" target="_blank" title="Twitter"><i class="fab fa-X"></i></a><a class="social-icon" href="mailto:mokong.2015.1992@email.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#iOS-APP%E6%B7%BB%E5%8A%A0%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">iOS APP添加桌面快捷方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.2.</span> <span class="toc-text">实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-number">1.2.1.</span> <span class="toc-text">准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">1.2.2.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">1.2.3.</span> <span class="toc-text">方法二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%B2%A1%E5%AE%8C"><span class="toc-number">1.2.4.</span> <span class="toc-text">还没完</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.4.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/22/Google%20Antigravity%20%E7%99%BB%E5%BD%95%E4%B8%8D%E4%BA%86%E8%A7%A3%E5%86%B3/" title="Google Antigravity 登录不了解决">Google Antigravity 登录不了解决</a><time datetime="2026-01-22T02:38:00.000Z" title="发表于 2026-01-22 10:38:00">2026-01-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/%E8%BF%9E%E5%A4%9C%E5%BC%80%E5%8F%91%E4%BA%86%E4%B8%80%E4%B8%AA%20Mac%20%E4%B8%8A%E4%B9%85%E5%9D%90%E6%8F%90%E9%86%92%E5%B7%A5%E5%85%B7/" title="连夜开发了一个 Mac 上久坐提醒工具">连夜开发了一个 Mac 上久坐提醒工具</a><time datetime="2026-01-21T13:45:00.000Z" title="发表于 2026-01-21 21:45:00">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/20/%E5%85%B3%E4%BA%8E%20AI%20%E4%B8%8E%E5%BC%80%E5%8F%91/" title="关于 AI 与开发">关于 AI 与开发</a><time datetime="2026-01-20T11:41:00.000Z" title="发表于 2026-01-20 19:41:00">2026-01-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/16/%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E8%A1%A8%E6%83%85%E5%8C%85/" title="制作自己表情包">制作自己表情包</a><time datetime="2026-01-16T02:21:00.000Z" title="发表于 2026-01-16 10:21:00">2026-01-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/13/%E9%B8%BF%E8%92%99%E6%88%AA%E5%9B%BE%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="鸿蒙截图生成工具">鸿蒙截图生成工具</a><time datetime="2025-10-13T07:24:00.000Z" title="发表于 2025-10-13 15:24:00">2025-10-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2026 By 今是昨非</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div><div class="footer_custom_text"><span>日出江花红胜火，春来江水绿如蓝，能不忆江南</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>