<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>集成腾讯短视频SDK记录 | 今是昨非的博客</title><meta name="author" content="今是昨非"><meta name="copyright" content="今是昨非"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="集成腾讯短视频SDK记录有需求是录制一段视频并上传，服务端可见。最后才用集成腾讯SDK的方式，走了一些弯路，这里记录一下。">
<meta property="og:type" content="article">
<meta property="og:title" content="集成腾讯短视频SDK记录">
<meta property="og:url" content="http://morganwang.cn/2023/11/22/%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E5%86%B2%E7%AA%81%E4%BF%AE%E6%94%B9/index.html">
<meta property="og:site_name" content="今是昨非的博客">
<meta property="og:description" content="集成腾讯短视频SDK记录有需求是录制一段视频并上传，服务端可见。最后才用集成腾讯SDK的方式，走了一些弯路，这里记录一下。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://morganwang.cn/assets/img/avatar.jpeg">
<meta property="article:published_time" content="2023-11-22T08:27:00.000Z">
<meta property="article:modified_time" content="2024-01-22T11:04:42.000Z">
<meta property="article:author" content="今是昨非">
<meta property="article:tag" content="技术">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://morganwang.cn/assets/img/avatar.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "集成腾讯短视频SDK记录",
  "url": "http://morganwang.cn/2023/11/22/%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E5%86%B2%E7%AA%81%E4%BF%AE%E6%94%B9/",
  "image": "http://morganwang.cn/assets/img/avatar.jpeg",
  "datePublished": "2023-11-22T08:27:00.000Z",
  "dateModified": "2024-01-22T11:04:42.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "今是昨非",
      "url": "http://morganwang.cn"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://morganwang.cn/2023/11/22/%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E5%86%B2%E7%AA%81%E4%BF%AE%E6%94%B9/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '集成腾讯短视频SDK记录',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">190</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1477346611705-65d1883cee1e);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">今是昨非的博客</span></a><a class="nav-page-title" href="/"><span class="site-name">集成腾讯短视频SDK记录</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">集成腾讯短视频SDK记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-22T08:27:00.000Z" title="发表于 2023-11-22 16:27:00">2023-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-22T11:04:42.000Z" title="更新于 2024-01-22 19:04:42">2024-01-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="集成腾讯短视频SDK记录"><a href="#集成腾讯短视频SDK记录" class="headerlink" title="集成腾讯短视频SDK记录"></a>集成腾讯短视频SDK记录</h1><p>有需求是录制一段视频并上传，服务端可见。最后才用集成腾讯SDK的方式，走了一些弯路，这里记录一下。</p>
<span id="more"></span>

<h2 id="SDK-选择"><a href="#SDK-选择" class="headerlink" title="SDK 选择"></a>SDK 选择</h2><p>首先是SDK选择，对于iOS来说是腾讯的<a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/584/11638">短视频SDK</a></p>
<h2 id="SDK集成"><a href="#SDK集成" class="headerlink" title="SDK集成"></a>SDK集成</h2><p>然后是，SDK集成，按照上面链接步骤，把<code>TXLiteAVSDK_UGC.framework</code>和依赖的系统库集成到项目中，然后添加plist权限，再添加UGCKit模块，发现编译失败。<br>对于我的项目来说，是因为 WCDB 库冲突，项目中使用的私有库封装了 WCDB，使用的是静态库的方式。和上面 SDK中冲突了，所以需要单独设置。修改了好久，编译通过之后，运行后发现，WCDB 初始化失败，又排查了好久，最终解决方法是：</p>
<p>在 Build Settings 中的 Other Linker Flags，设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-force_load</span><br><span class="line">&quot;$&#123;PODS_CONFIGURATION_BUILD_DIR&#125;/WCDBOptimizedSQLCipher/libWCDBOptimizedSQLCipher.a&quot;</span><br></pre></td></tr></table></figure>

<p>如下：</p>
<p><img src="../assets/img/image-1.png" alt="Alt text"></p>
<p>然后是，发现按照上面步骤集成后，安装包大小从 27M到 156M。。。再次排查后，发现，整个 UGCKit 模块不需要添加，因为我们的录制并没有用 UGCKit 封装好的类，而是自定义的类，用的是<code>TXLiteAVSDK_UGC.framework</code> 的功能，整个 UGCKit 模块移除后，就又变为 27M左右 的大小。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/584/11638">文档中心 &gt; 短视频 SDK &gt; 不含 UI 集成方案 &gt; SDK 集成 &gt; SDK 集成(XCode)</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://morganwang.cn">今是昨非</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://morganwang.cn/2023/11/22/%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E5%86%B2%E7%AA%81%E4%BF%AE%E6%94%B9/">http://morganwang.cn/2023/11/22/%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E5%86%B2%E7%AA%81%E4%BF%AE%E6%94%B9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://morganwang.cn" target="_blank">今是昨非的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8A%80%E6%9C%AF/">技术</a></div><div class="post-share"><div class="social-share" data-image="/assets/img/avatar.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/01/07/iOS%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/" title="一文学会iOS蓝牙开发"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">一文学会iOS蓝牙开发</div></div><div class="info-2"><div class="info-item-1">一文学会iOS蓝牙开发背景最近做APP对接蓝牙设备开发，这里分享一下iOS对接蓝牙设备中需要注意的东西，大致包含下面这些方面：    Xcode蓝牙权限 如何扫描蓝牙设备、获取Mac地址 不同蓝牙设备切换 写入蓝牙命令 data转16进制字符串 16进制转String crc算法 数据异或计算，字符串异或 负数异或计算     依次写入多个命令  蓝牙开发的大致流程首先来了解一下蓝牙开发的流程，总结如下： Xcode配置蓝牙权限 -&gt; 启动蓝牙 -&gt; 扫描周围蓝牙 -&gt; 连接指定蓝牙 -&gt; 校验是否连接成功 -&gt; 蓝牙读/写 -&gt; 断开连接 流程图如下：  具体步骤1. 配置Xcode蓝牙权限 General Tab下，Frameworks,Libraries, and Embedded Content中添加 CoreBluetooth.framework，如下图：  Signing &amp; Capabilities Tab下，Background Modes中，勾选Uses Bluetooth LE accessories，如下图：   ...</div></div></div></a><a class="pagination-related" href="/2023/11/22/ArkTS%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5/" title="Mac安装ArkTS失败"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Mac安装ArkTS失败</div></div><div class="info-2"><div class="info-item-1">Mac安装ArkTS失败错误提示： 1234567Installing ArkTS dependencies...Running &#x27;npm install&#x27;...npm ERR! code ETARGET   参考：ArkTS 安装失败求助，是node版本太高的原因，需要降级node。 查看node版本： 1node -v  通过brew安装的node，降级node时，先安装nvm 123brew install nvm  然后通过nvm安装低版本的node 1nvm install v14.21.3  安装完成后，再次查看node版本，如果node版本还不对，再运行下面命令 1nvm use v14.21.3  node降级之后，需要清理npm 缓存， 1npm cache clean -f  然后重启DevEco-Studio，再次尝试安装，即可安装成功。 补充如果其他地方使用有高版本的node，可以安装两个版本的 node，然后使用 nvm 命令切换，或者 node 的安装不安装到全局也可。 参考 ArkTS 安装失败求助 HarmonyOS Devel...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2022/06/11/iOS%20The%20'Pods-App'%20target%20has%20transitive%20dependencies%20that%20include%20static%20binaries/" title="The &#39;Pods-App&#39; target has transitive dependencies that include static binaries"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-11</div><div class="info-item-2">The &#39;Pods-App&#39; target has transitive dependencies that include static binaries</div></div><div class="info-2"><div class="info-item-1">The ‘Pods-App’ target has transitive dependencies that include static binaries:修改背景最近遇到了两次次这个问题，都是Swift项目Pod添加库开启了use_frameworks!，安装某些OC库时报错；花了好久时间解决，突然想起来之前OC项目安装Swift库也遇到了这个问题，但是之前没有记录，所以这次遇到时没有印象；这次记录下来，分享给大家：   解决方案之前遇到的是OC代码安装ZLPhotoBrowser的Swift库，开启了use_frameworks!，和其他第三方库一起安装时，可以理解为，除了ZLPhotoBrowser是动态库，其他的第三方库默认都使用static_framework或者static_library。 Pod文件末尾添加下面代码： 12345678910111213141516171819use_frameworks!...dynamic_frameworks = [&#x27;ZLPhotoBrowser&#x27;]pre_install do |installer|  ...</div></div></div></a><a class="pagination-related" href="/2022/04/20/Algorithem_MaxAreaOfIsland/" title="Algorithem_Max Area of Island"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-20</div><div class="info-item-2">Algorithem_Max Area of Island</div></div><div class="info-2"><div class="info-item-1">733. Algorithem_Max Area of IslandYou are given an m x n binary matrix grid. An island is a group of 1’s (representing land) connected 4-directionally (horizontal or vertical.) You may assume all four edges of the grid are surrounded by water.   The area of an island is the number of cells with a value 1 in the island. Return the maximum area of an island in grid. If there is no island, return 0. Example 1:  123Input: grid = [[0,0,1,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,1,1,1,0,0,0],[0,1,1,0,1,...</div></div></div></a><a class="pagination-related" href="/2021/09/10/gitignore%E6%B7%BB%E5%8A%A0%20Pod%E4%B8%89%E6%96%B9%E5%BA%93/" title="gitignore 添加 Pod 三方库"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-10</div><div class="info-item-2">gitignore 添加 Pod 三方库</div></div><div class="info-2"><div class="info-item-1">背景最近项目遇到了一个问题，排查了好久，最后发现是Pod 依赖的私有组件的代码有问题，导致了打包的时候线上包出现了问题。   笔者的项目按照功能抽象出了私有组件，使用 Pod 的方式导入项目，但是 Pod的内容是不提交到 git 的，即每次 Pod 修改，在 主项目的git变更中看不到。于是就遇到了这个问题。 先在主项目中调试的时候，修改了 Pod库的内容。然后把修改内容同步到了 Pod 库单独的项目。但是最后打包的时候 Pod 库的内容却是老的。因为项目里依赖的 Pod 库指定了版本，而更新 Pod库单独的项目时，只同步到了分支上，没有更新新的 Tag。于是再次更新主项目的库时，这个库的内容就又变回了老的。 Ps：理论上来说，放入 Pod 库的内容不应该被频繁修改，是抽出的基础库之类的。但是实际开发中，为了组件化，有些功能组件也会作为私有库使用 Pod 依赖，这些库可能是频繁变更的。 基于这点，笔者感觉还是把 Pod 中的内容，放入主项目的 .git 中比较好，方便看出修改，能够避免出现上面的问题。 修改笔者直接进入项目工程所在目录，编辑.gitignore文件，移出文件中 #...</div></div></div></a><a class="pagination-related" href="/2021/07/19/Flutter%E7%BB%84%E4%BB%B6%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94Text/" title="Flutter组件基础——Text"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-19</div><div class="info-item-2">Flutter组件基础——Text</div></div><div class="info-2"><div class="info-item-1">Flutter组件基础——Text组件文本组件：Text WidgetText是文本组件，类似于iOS中UILabel，用于文本的展示，是布局的基础控件之一。   文本对齐方式：TextAlign TextAlign center：Align the text in the center of the cotainer left：Align the text on the left edge of the container right：Align the text on the right edge of the container start：Align the text on the leading edge of the container. For left-to-right text(TextDirection.ltr), this is the left edge. For the right-to-left text(TextDirection.rtl), this is the right edge. end：Align the text on the trai...</div></div></div></a><a class="pagination-related" href="/2021/05/12/iOS%20mach-o%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%9A%E4%BD%99%E7%9A%84%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/" title="iOS mach-o文件分析多余的类和方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-12</div><div class="info-item-2">iOS mach-o文件分析多余的类和方法</div></div><div class="info-2"><div class="info-item-1">mach-o文件分析多余的类和方法.md背景最近做包大小优化，在做项目代码优化时，其中有一个过程是分析Mach-O文件，看网上很多文章都说通过otool分析Mach-O，获取__objc_classrefs、__objc_classlist等，然后找出无用类和无用方法。   比如：无用类通过 otool 逆向Mach-O文件 __DATA.__objc_classlist段和__DATA.__objc_classrefs 段获取所有 OC 类和被引用的类，两个集合差值为无用类集合，结合 nm -nm 得到地址和对应类名符号化无用类类名来自干货！京东商城iOS App瘦身实践 又或者结合LinkMap文件的__TEXT.__text，通过正则表达式([+|-][.+\s(.+)])，我们可以提取当前可执行文件里所有objc类方法和实例方法（SelectorsAll）。再使用otool命令otool -v -s __DATA __objc_selrefs逆向__DATA.__objc_selrefs段，提取可执行文件里引用到的方法名（UsedSelectorsAll），我们可以大致分...</div></div></div></a><a class="pagination-related" href="/2022/03/29/SDWebImage%20%E6%B7%BB%E5%8A%A0%20token/" title="更新：SDWebImage 添加 token"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-29</div><div class="info-item-2">更新：SDWebImage 添加 token</div></div><div class="info-2"><div class="info-item-1">背景网上搜到的关于SDWebImage 添加 token，亦或者 SDWebImage add header的方法，都是直接使用SDWebImageDownloader中的setValue:forHTTPHeaderField:方法来设置。但是设置了之后笔者这边图片还是出不来，仔细研究后发现笔者这边的图片显示是先经过一次302跳转，然后跳转后才是真正的图片链接，第二次的这个链接是需要 token 的。   而直接设置SDWebImageDownloader的HTTPHeaderField设置到了第一个链接上面，302重定向后第二个链接的HTTPHeaderField仍是没有 token 解决方法一般来说，直接使用SDWebImageDownloader中的setValue:forHTTPHeaderField:方法设置即可。如下： 12345678- (void)addSDWebImageToken &#123;    SDWebImageDownloader *downloader = [SDWebImageDownloader sharedDownloader];    NS...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">今是昨非</div><div class="author-info-description">技术分享、生活感悟</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">190</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mokong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/mokong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://x.com/morgan2015_wang" target="_blank" title="Twitter"><i class="fab fa-X"></i></a><a class="social-icon" href="mailto:mokong.2015.1992@email.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%86%E6%88%90%E8%85%BE%E8%AE%AF%E7%9F%AD%E8%A7%86%E9%A2%91SDK%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">集成腾讯短视频SDK记录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SDK-%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.</span> <span class="toc-text">SDK 选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SDK%E9%9B%86%E6%88%90"><span class="toc-number">1.2.</span> <span class="toc-text">SDK集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.3.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/27/CodeBuddyCN%20%E4%BD%BF%E7%94%A8%E5%85%8D%E8%B4%B9%E7%9A%84%E4%B8%83%E7%89%9B%20Model%20%E6%AD%A5%E9%AA%A4/" title="CodeBuddyCN 使用免费的七牛 Model 步骤">CodeBuddyCN 使用免费的七牛 Model 步骤</a><time datetime="2026-01-27T11:49:00.000Z" title="发表于 2026-01-27 19:49:00">2026-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/22/Google%20Antigravity%20%E7%99%BB%E5%BD%95%E4%B8%8D%E4%BA%86%E8%A7%A3%E5%86%B3/" title="Google Antigravity 登录不了解决">Google Antigravity 登录不了解决</a><time datetime="2026-01-22T02:38:00.000Z" title="发表于 2026-01-22 10:38:00">2026-01-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/%E8%BF%9E%E5%A4%9C%E5%BC%80%E5%8F%91%E4%BA%86%E4%B8%80%E4%B8%AA%20Mac%20%E4%B8%8A%E4%B9%85%E5%9D%90%E6%8F%90%E9%86%92%E5%B7%A5%E5%85%B7/" title="连夜开发了一个 Mac 上久坐提醒工具">连夜开发了一个 Mac 上久坐提醒工具</a><time datetime="2026-01-21T13:45:00.000Z" title="发表于 2026-01-21 21:45:00">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/20/%E5%85%B3%E4%BA%8E%20AI%20%E4%B8%8E%E5%BC%80%E5%8F%91/" title="关于 AI 与开发">关于 AI 与开发</a><time datetime="2026-01-20T11:41:00.000Z" title="发表于 2026-01-20 19:41:00">2026-01-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/16/%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E8%A1%A8%E6%83%85%E5%8C%85/" title="制作自己表情包">制作自己表情包</a><time datetime="2026-01-16T02:21:00.000Z" title="发表于 2026-01-16 10:21:00">2026-01-16</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2026 By 今是昨非</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div><div class="footer_custom_text"><span>日出江花红胜火，春来江水绿如蓝，能不忆江南</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>