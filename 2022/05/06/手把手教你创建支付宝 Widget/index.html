<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>iOS Widget | ä»Šæ˜¯æ˜¨éçš„åšå®¢</title><meta name="author" content="ä»Šæ˜¯æ˜¨é"><meta name="copyright" content="ä»Šæ˜¯æ˜¨é"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="iOS WidgetèƒŒæ™¯ä¸€å¼€å§‹æ˜¯å‘ç°æ”¯ä»˜å®çš„ Widget åšçš„å¾ˆå¥½çœ‹ï¼Œæ‰“ç®—ä»¿ä½œä¸€ä¸ªï¼Œåšçš„è¿‡ç¨‹ä¸­æ‰å‘ç°ï¼ŒåŸæ¥ Widget æœ‰è¿™ä¹ˆå¤šå¥½ç©çš„åœ°æ–¹ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™é‡Œè®°å½•åˆ†äº«ä¸€ä¸‹ï¼š">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS Widget">
<meta property="og:url" content="http://morganwang.cn/2022/05/06/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%88%9B%E5%BB%BA%E6%94%AF%E4%BB%98%E5%AE%9D%20Widget/index.html">
<meta property="og:site_name" content="ä»Šæ˜¯æ˜¨éçš„åšå®¢">
<meta property="og:description" content="iOS WidgetèƒŒæ™¯ä¸€å¼€å§‹æ˜¯å‘ç°æ”¯ä»˜å®çš„ Widget åšçš„å¾ˆå¥½çœ‹ï¼Œæ‰“ç®—ä»¿ä½œä¸€ä¸ªï¼Œåšçš„è¿‡ç¨‹ä¸­æ‰å‘ç°ï¼ŒåŸæ¥ Widget æœ‰è¿™ä¹ˆå¤šå¥½ç©çš„åœ°æ–¹ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™é‡Œè®°å½•åˆ†äº«ä¸€ä¸‹ï¼š">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://morganwang.cn/assets/img/avatar.jpeg">
<meta property="article:published_time" content="2022-05-06T06:00:00.000Z">
<meta property="article:modified_time" content="2024-01-22T11:04:42.000Z">
<meta property="article:author" content="ä»Šæ˜¯æ˜¨é">
<meta property="article:tag" content="æŠ€æœ¯">
<meta property="article:tag" content="iOS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://morganwang.cn/assets/img/avatar.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "iOS Widget",
  "url": "http://morganwang.cn/2022/05/06/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%88%9B%E5%BB%BA%E6%94%AF%E4%BB%98%E5%AE%9D%20Widget/",
  "image": "http://morganwang.cn/assets/img/avatar.jpeg",
  "datePublished": "2022-05-06T06:00:00.000Z",
  "dateModified": "2024-01-22T11:04:42.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "ä»Šæ˜¯æ˜¨é",
      "url": "http://morganwang.cn"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://morganwang.cn/2022/05/06/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%88%9B%E5%BB%BA%E6%94%AF%E4%BB%98%E5%AE%9D%20Widget/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'iOS Widget',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">189</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1477346611705-65d1883cee1e);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ä»Šæ˜¯æ˜¨éçš„åšå®¢</span></a><a class="nav-page-title" href="/"><span class="site-name">iOS Widget</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">iOS Widget</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-05-06T06:00:00.000Z" title="å‘è¡¨äº 2022-05-06 14:00:00">2022-05-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-01-22T11:04:42.000Z" title="æ›´æ–°äº 2024-01-22 19:04:42">2024-01-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="iOS-Widget"><a href="#iOS-Widget" class="headerlink" title="iOS Widget"></a>iOS Widget</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä¸€å¼€å§‹æ˜¯å‘ç°æ”¯ä»˜å®çš„ Widget åšçš„å¾ˆå¥½çœ‹ï¼Œæ‰“ç®—ä»¿ä½œä¸€ä¸ªï¼Œåšçš„è¿‡ç¨‹ä¸­æ‰å‘ç°ï¼ŒåŸæ¥ Widget æœ‰è¿™ä¹ˆå¤šå¥½ç©çš„åœ°æ–¹ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™é‡Œè®°å½•åˆ†äº«ä¸€ä¸‹ï¼š</p>
<span id="more"></span>

<p>ä½ çŸ¥é“å¦‚ä½•åˆ›å»ºç±»ä¼¼äº QQ åŒæ­¥åŠ©æ‰‹çš„ Widget å—ï¼Ÿ</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2049.PNG" width="30%">
</figure>

<p>ä½ çŸ¥é“ç±»ä¼¼äºä¸œæ–¹è´¢å¯Œçš„ä¸åŒç»„ Widget æ•ˆæœæ˜¯æ€ä¹ˆå®ç°çš„å—ï¼Ÿ</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2050.PNG" width="30%">
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2052.PNG" width="30%">
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2051.PNG" width="30%">
</figure>

<p>ä½ çŸ¥é“ä¸‹å›¾ä¸­æ”¯ä»˜å®WidgetåŠŸèƒ½æ˜¯æ€ä¹ˆå®ç°çš„å—ï¼Ÿ</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2053.PNG" width="24%">
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2056.PNG" width="24%">
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2057.PNG" width="24%">
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/IMG_2058.PNG" width="24%">
<figure>

<p>æˆ–è€…è¿™ä¹ˆé—®ï¼Œå¯¹äºè¿™å‡ ä¸ªçš„æ¦‚å¿µï¼š<code>supportedFamilies</code>ã€<code>WidgetBundle</code>ä»¥åŠ<code>Configurable Widget</code>æ˜¯å¦çŸ¥æ™“ï¼Œå¦‚æœéƒ½çŸ¥é“ï¼Œé‚£å°±ä¸éœ€è¦çœ‹æœ¬ç¯‡æ–‡ç« äº†ã€‚</p>
<ul>
<li>QQ åŒæ­¥åŠ©æ‰‹çš„Widgetåªæ˜¾ç¤ºä¸€ä¸ªWidgetçš„æ•ˆæœï¼Œæ˜¯è®¾ç½®äº† Widget çš„<code>supportedFamilies</code>åªæœ‰systemMedium æ ·å¼ï¼›</li>
<li>ä¸œæ–¹è´¢å¯Œçš„å¤šç»„ Widgetï¼Œæ˜¯é€šè¿‡<code>WidgetBundle</code>å®ç°çš„ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªWidgetï¼Œæ¯ä¸ª Widget éƒ½å¯ä»¥è®¾ç½®è‡ªå·±çš„å¤§ä¸­å°ï¼›åŒºåˆ†æ˜¯å¦ä½¿ç”¨äº† <code>WidgetBundle</code>ï¼Œå¯ä»¥é€šè¿‡æ»‘åŠ¨æ—¶ï¼ŒWidgeté¢„è§ˆç•Œé¢åŒæ­¥çš„æ–‡å­—æ˜¯å¦è·Ÿç€æ»‘åŠ¨æ¥åŒºåˆ†ï¼šåŒä¸€ä¸ª Widget çš„å¤§ä¸­å°ä¸åŒæ ·å¼ï¼Œæ»‘åŠ¨æ—¶é¡¶éƒ¨çš„æ ‡é¢˜å’Œæè¿°æ˜¯ä¸ä¼šåŠ¨çš„ï¼›ä¸åŒç»„çš„ Widgetï¼Œæ¯ä¸ª Widget éƒ½æœ‰è‡ªå·±çš„æ ‡é¢˜å’Œæè¿°ï¼Œæ»‘åŠ¨æ—¶ï¼Œæ–‡å­—æ˜¯è·Ÿç€ä¸€èµ·æ»‘åŠ¨çš„ã€‚</li>
<li>æ”¯ä»˜å®çš„ Widgetï¼Œä½¿ç”¨äº†<code>Configurable Widget</code>ï¼Œå®šä¹‰äº†<code>Enum</code>ç±»å‹å’Œè‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œè®¾ç½®Intent çš„<code>Dynamic Options</code>å’Œ<code>Supports multiple values</code>ã€‚</li>
</ul>
<h2 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h2><p>å¼€å§‹å‰çš„è¯´æ˜ï¼š<br>å¦‚æœè¦ç”¨åˆ° APP å’Œ Widget ä¼ å€¼é€šä¿¡ï¼Œæ¯”å¦‚æ”¯ä»˜å®ä¸­å¤©æ°”çš„æ˜¾ç¤ºï¼Œä» APP å®šä½è·å–çš„åŸå¸‚ï¼Œä¿å­˜åˆ°æœ¬åœ°ï¼Œä» Widget ä¸­è·å–åˆ°æœ¬åœ°ä¿å­˜çš„åŸå¸‚ï¼Œå†å»è·å–å¤©æ°”ã€‚è¿™ä¸­é—´çš„ä¼ å€¼éœ€è¦ APPGroupï¼Œå¦‚æœä¸éœ€è¦ APP å’Œ Widget ä¼ å€¼çš„ï¼Œåˆ™ä¸éœ€è¦è®¾ç½®APPGroupï¼›ä½†æ˜¯å¦‚æœè®¾ç½® APPGroup çš„è¯ï¼Œéœ€è¦æ³¨æ„ Widget å’Œä¸» APP çš„ APPGroup è¦ä¸€è‡´ã€‚APPGroup çš„è¯¦ç»†ä½¿ç”¨å¯å‚è€ƒ<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/94d4106b9298">Appä¹‹é—´çš„æ•°æ®å…±äº«â€”â€”App Groupçš„é…ç½®</a>ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è¯´æ˜äº†ã€‚</p>
<h3 id="åˆ›å»º-Widget"><a href="#åˆ›å»º-Widget" class="headerlink" title="åˆ›å»º Widget"></a>åˆ›å»º Widget</h3><p>åˆ›å»º Widgetï¼Œé€‰æ‹© File -&gt; New -&gt; Target -&gt; Widget Extensionã€‚</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/create%20widget.png" width="70%">
</figure>

<p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥ Widget çš„åå­—ï¼Œå–æ¶ˆå‹¾é€‰Include Configuration Intentã€‚</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/input%20widget%20name.png" width="70%">
</figure>

<p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œä¼šå‡ºç°æ˜¯å¦åˆ‡æ¢ Target çš„æç¤ºï¼Œå¦‚ä¸‹ï¼Œç‚¹å‡»Activateï¼Œåˆ‡æ¢åˆ° Widget Targetï¼›</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/Activate.png" width="50%">
</figure>

<p>ä¸Šé¢çš„æ­¥éª¤ç‚¹å‡» Activateæˆ–è€…å–æ¶ˆéƒ½å¯ä»¥ï¼›ç‚¹å‡» Activate æ˜¯ Xcodeä¸»åŠ¨æŠŠ Targetåˆ‡æ¢åˆ° Widgetï¼Œç‚¹å‡»å–æ¶ˆæ˜¯ä¿æŒå½“å‰ Targetã€‚éšæ—¶å¯ä»¥æ‰‹åŠ¨åˆ‡æ¢ã€‚</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/choose%20target.png">
</figure>

<p>è¿™æ · Widget å°±åˆ›å»ºå¥½äº†ï¼Œæ¥çœ‹ä¸‹ç›®å‰é¡¹ç›®çš„ç»“æ„ï¼Œå¦‚ä¸‹</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/screenshot-20220511-174147.png">
</figure>

<p>å†æ¥çœ‹ä¸‹ï¼ŒWidget ä¸­.swift æ–‡ä»¶çš„ä»£ç ï¼Œå…¥å£å’Œä»£ç†æ–¹æ³•éƒ½åœ¨è¿™ä¸ªç±»ä¸­ï¼š</p>
<p>å…¶ä¸­åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œå¦‚ä¸‹</p>
<ul>
<li>TimeLineProviderï¼Œprotocol ç±»å‹å®šä¹‰äº†ä¸‰ä¸ªå¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œç”¨äº Widget çš„é»˜è®¤å±•ç¤ºå’Œä½•æ—¶åˆ·æ–°<ul>
<li><code>func placeholder(in context: Context) -&gt; SimpleEntry</code></li>
<li><code>func getSnapshot(in context: Context, completion: @escaping (SimpleEntry) -&gt; ())</code>è¿™ä¸ªæ–¹æ³•å®šä¹‰Widgeté¢„è§ˆä¸­å¦‚ä½•å±•ç¤ºï¼Œæ‰€ä»¥æä¾›é»˜è®¤å€¼è¦åœ¨è¿™é‡Œ</li>
<li><code>func getTimeline(in context: Context, completion: @escaping (Timeline&lt;Entry&gt;) -&gt; ())</code>è¿™ä¸ªæ–¹æ³•é‡Œï¼Œå†³å®š Widget ä½•æ—¶åˆ·æ–°</li>
</ul>
</li>
<li>TimelineEntryï¼Œè¿™ä¸ªç±»ä¹Ÿæ˜¯å¿…é¡»å®ç°çš„ï¼Œé‡Œé¢çš„ Date ç”¨äºåˆ¤æ–­åˆ·æ–°æ—¶æœºï¼Œå¦‚æœæœ‰è‡ªå®šä¹‰ Intent çš„è¯ï¼Œä¹Ÿæ˜¯ä»è¿™é‡Œä¼ å€¼åˆ° View</li>
<li>Viewï¼ŒWidgetçš„ View</li>
<li>Widgetï¼ŒWidget çš„ title å’Œ descriptionï¼Œä»¥åŠ supportedFamilieséƒ½åœ¨è¿™é‡Œè®¾ç½®</li>
<li>PreviewProviderï¼Œè¿™ä¸ªæ˜¯SwiftUI çš„é¢„è§ˆï¼Œå³è¾¹ä¿®æ”¹è¾¹çœ‹æ•ˆæœï¼Œå¯åˆ é™¤</li>
</ul>
<p>çœ‹å®Œä¸Šé¢å¯èƒ½è¿˜æ˜¯ä¸€å¤´é›¾æ°´ï¼Œä¸è¦ç´§ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼Œè·Ÿç€åšä¸€ä¸¤ä¸ª Widget å°±æ˜ç™½æ¯ä¸ªéƒ¨åˆ†çš„ä½œç”¨äº†ã€‚</p>
<h3 id="QQ-åŒæ­¥åŠ©æ‰‹çš„-Widget"><a href="#QQ-åŒæ­¥åŠ©æ‰‹çš„-Widget" class="headerlink" title="QQ åŒæ­¥åŠ©æ‰‹çš„ Widget"></a>QQ åŒæ­¥åŠ©æ‰‹çš„ Widget</h3><h4 id="WidgetUI-åˆ›å»º"><a href="#WidgetUI-åˆ›å»º" class="headerlink" title="WidgetUI åˆ›å»º"></a>WidgetUI åˆ›å»º</h4><p>å…ˆæ¥åšä¸€ä¸ªæœ€ç®€å•çš„ QQ åŒæ­¥åŠ©æ‰‹çš„ Widgetï¼Œä¸‹è½½<code>Tutorial1</code>æ–‡ä»¶å¤¹ä¸­çš„é¡¹ç›®ï¼Œæ‰“å¼€ï¼Œæ–°å»º<code>SwiftUIView</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/20220601092226.png" width="70%">
</figure>

<p>ç‚¹å‡»Nextï¼Œæ–‡ä»¶åå­—è¾“å…¥<code>QQSyncWidgetView</code>ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„é€‰ä¸­çš„ Target æ˜¯ Widget çš„ Targetï¼Œè€Œä¸æ˜¯ä¸»å·¥ç¨‹çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/20220601092644.png" width="70%">
</figure>

<p>ç„¶åæ‰“å¼€<code>QQSyncWidgetView</code>ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  QQSyncWidgetView.swift</span></span><br><span class="line"><span class="comment">//  DemoWidgetExtension</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by Horizon on 01/06/2022.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="comment">/*@START_MENU_TOKEN@*/</span><span class="string">&quot;Hello, World!&quot;</span><span class="comment">/*@END_MENU_TOKEN@*/</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView_Previews</span>: <span class="title">PreviewProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">QQSyncWidgetView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œ<code>QQSyncWidgetView</code>ä¸­æ˜¯<code>SwiftUI</code> View çš„ä»£ç ï¼Œå³è¦ä¿®æ”¹å¸ƒå±€çš„åœ°æ–¹ï¼›<code>QQSyncWidgetView_Previews</code>æ˜¯æ§åˆ¶é¢„è§ˆ View çš„ï¼Œå¯ä»¥åˆ é™¤ã€‚ç„¶åæ¥çœ‹è¦å®ç°çš„ QQ åŒæ­¥åŠ©æ‰‹çš„ WidgetåŒ…å«æœ‰å“ªäº›å†…å®¹ï¼š</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/20220606100905.png" width="70%">
</figure>

<p>å¦‚ä¸Šå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼ŒèƒŒæ™¯å›¾ç‰‡ã€å·¦ä¾§æ–‡å­— Viewã€å³ä¾§æ–‡å­— Viewï¼ŒèƒŒæ™¯å›¾ç‰‡å’Œä¸¤ä¸ª View ä¹‹é—´å‰åå…³ç³»ç”¨ ZStack çš„å®ç°ï¼Œä¸¤ä¸ª View ä¹‹é—´å·¦å³å…³ç³»ç”¨ HStackï¼ŒView é‡Œé¢çš„æ–‡å­—çš„ä¸Šä¸‹å¸ƒå±€æ˜¯ VStackï¼Œæµ‹è¯•ç”¨çš„èµ„æºæ–‡ä»¶æ”¾åœ¨<code>QQSyncImages</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p>
<p><code>SwiftUI</code>çš„å†…å®¹å¯ä»¥å‚è€ƒæ–¯å¦ç¦è€çˆ·å­çš„æ•™ç¨‹ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://cs193p.sites.stanford.edu/">https://cs193p.sites.stanford.edu/</a></li>
</ul>
<p>å¡«å……å†…å®¹åå¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;widget_background_test&quot;</span>)</span><br><span class="line">                .resizable()</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// å·¦å³ä¸¤ä¸ª View</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                <span class="comment">// å·¦ View</span></span><br><span class="line">                <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;æ‰€æœ‰å¿«ä¹éƒ½å‘ä½ é æ‹¢ï¼Œæ‰€æœ‰å¥½è¿éƒ½åœ¨è·¯ä¸Šã€‚&quot;</span>)</span><br><span class="line">                        .font(.system(size: <span class="number">19.0</span>))</span><br><span class="line">                        .fontWeight(.semibold)</span><br><span class="line">                        .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                        .foregroundColor(.white)</span><br><span class="line"></span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    </span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;åŠ æ²¹ï¼Œæ‰“å·¥äººï¼ğŸ˜„&quot;</span>)</span><br><span class="line">                        .font(.system(size: <span class="number">16.0</span>))</span><br><span class="line">                        .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                        .foregroundColor(.white)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// å³ View</span></span><br><span class="line">                <span class="type">VStack</span> &#123;</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;06&quot;</span>)</span><br><span class="line">                        .font(.system(size: <span class="number">50.0</span>))</span><br><span class="line">                        .fontWeight(.semibold)</span><br><span class="line">                        .foregroundColor(.white)</span><br><span class="line">                        .padding(<span class="type">EdgeInsets</span>(top: <span class="operator">-</span><span class="number">10.0</span>, leading: <span class="number">0.0</span>, bottom: <span class="operator">-</span><span class="number">10.0</span>, trailing: <span class="number">0.0</span>))</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;06æœˆ å‘¨ä¸€&quot;</span>)</span><br><span class="line">                        .lineLimit(<span class="number">1</span>)</span><br><span class="line">                        .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                        .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                        .foregroundColor(.white)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">&quot;å»åˆ†äº«&quot;</span>)</span><br><span class="line">                        .fixedSize()</span><br><span class="line">                        .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                        .padding(<span class="type">EdgeInsets</span>(top: <span class="number">5.0</span>, leading: <span class="number">20.0</span>, bottom: <span class="number">5.0</span>, trailing: <span class="number">20.0</span>))</span><br><span class="line">                        .background(.white)</span><br><span class="line">                        .foregroundColor(.black)</span><br><span class="line">                        .cornerRadius(<span class="number">12.0</span>)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="type">EdgeInsets</span>(top: <span class="number">0.0</span>, leading: <span class="number">10.0</span>, bottom: <span class="number">0.0</span>, trailing: <span class="number">10.0</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹å…¥å£ï¼Œæ‰“å¼€<code>DemoWidget.swift</code>ï¼Œå…¶ä¸­<code>DemoWidgetEntryView</code>æ˜¯ç»„ä»¶æ˜¾ç¤ºçš„ Viewï¼Œæ‰€ä»¥è¿™é‡Œä¿®æ”¹ä¸ºåˆšåˆšåˆ›å»ºçš„<code>QQSyncWidgetView</code>ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DemoWidgetEntryView</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> entry: <span class="type">Provider</span>.<span class="type">Entry</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">QQSyncWidgetView</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/20220606172505.png" width="70%">
</figure>


<p>æ•ˆæœå·²ç»å’Œ QQ åŒæ­¥åŠ©æ‰‹çš„ç±»ä¼¼ï¼Œä½†æ˜¯ä¸Šé¢çš„ä»£ç è¿˜éœ€è¦å†ä¼˜åŒ–ä¸€ä¸‹ï¼Œç±»å¤ªè‡ƒè‚¿ï¼›å¯ä»¥æŠŠæ¯ä¸ª<code>VStack</code>å•ç‹¬å°è£…æˆä¸€ä¸ª viewï¼Œä¹Ÿèƒ½æ–¹ä¾¿å¤ç”¨ã€‚åˆ›å»ºSwiftUIView å‘½åä¸º<code>QQSyncQuoteTextView</code>ç”¨äºWidgetå·¦åŠè¾¹ çš„ view å±•ç¤ºï¼›åˆ›å»ºå³åŠè¾¹çš„ view å‘½åä¸º<code>QQSyncDateShareView</code>ï¼Œæœ€ç»ˆä»£ç ä¸ºï¼š</p>
<p><code>QQSyncQuoteTextView</code>ç±»ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncQuoteTextView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;æ‰€æœ‰å¿«ä¹éƒ½å‘ä½ é æ‹¢ï¼Œæ‰€æœ‰å¥½è¿éƒ½åœ¨è·¯ä¸Šã€‚&quot;</span>)</span><br><span class="line">                .font(.system(size: <span class="number">19.0</span>))</span><br><span class="line">                .fontWeight(.semibold)</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;åŠ æ²¹ï¼Œæ‰“å·¥äººï¼ğŸ˜„&quot;</span>)</span><br><span class="line">                .font(.system(size: <span class="number">16.0</span>))</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>QQSyncDateShareView</code>ç±»ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncDateShareView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;06&quot;</span>)</span><br><span class="line">                .font(.system(size: <span class="number">50.0</span>))</span><br><span class="line">                .fontWeight(.semibold)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">                .padding(<span class="type">EdgeInsets</span>(top: <span class="operator">-</span><span class="number">10.0</span>, leading: <span class="number">0.0</span>, bottom: <span class="operator">-</span><span class="number">10.0</span>, trailing: <span class="number">0.0</span>))</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;06æœˆ å‘¨ä¸€&quot;</span>)</span><br><span class="line">                .lineLimit(<span class="number">1</span>)</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;å»åˆ†äº«&quot;</span>)</span><br><span class="line">                .fixedSize()</span><br><span class="line">                .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                .padding(<span class="type">EdgeInsets</span>(top: <span class="number">5.0</span>, leading: <span class="number">20.0</span>, bottom: <span class="number">5.0</span>, trailing: <span class="number">20.0</span>))</span><br><span class="line">                .background(.white)</span><br><span class="line">                .foregroundColor(.black)</span><br><span class="line">                .cornerRadius(<span class="number">12.0</span>)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€åä¿®æ”¹<code>QQSyncWidgetView</code>ä¸ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;widget_background_test&quot;</span>)</span><br><span class="line">                .resizable()</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// å·¦å³ä¸¤ä¸ª View</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="comment">// å·¦ View</span></span><br><span class="line">                <span class="type">QQSyncQuoteTextView</span>()</span><br><span class="line">                                </span><br><span class="line">                <span class="comment">// å³ View</span></span><br><span class="line">                <span class="type">QQSyncDateShareView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="type">EdgeInsets</span>(top: <span class="number">0.0</span>, leading: <span class="number">10.0</span>, bottom: <span class="number">0.0</span>, trailing: <span class="number">10.0</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åå†è¿è¡Œï¼Œå‘ç°æ•ˆæœå’Œä¹‹å‰ç›¸åŒï¼Œbingoã€‚</p>
<h4 id="ä¸åŒwidget-å°ºå¯¸è®¾ç½®"><a href="#ä¸åŒwidget-å°ºå¯¸è®¾ç½®" class="headerlink" title="ä¸åŒwidget å°ºå¯¸è®¾ç½®"></a>ä¸åŒwidget å°ºå¯¸è®¾ç½®</h4><p>å†æ¥çœ‹ã€widget å¤§å°çš„è®¾ç½®ã€‘ï¼Œç›®å‰å¼€å‘çš„ Widget åœ¨ Medium å¤§å°æ—¶ï¼Œ æ˜¾ç¤ºæ˜¯æ­£å¥½çš„ï¼Œä½†æ˜¯è¿˜æœ‰Smallå’ŒLargeçš„å¤§å°ï¼Œæ˜¾ç¤ºéƒ½æ˜¯ä¸æ­£å¸¸çš„ï¼Œé‚£è¿™ä¸ªæ˜¯å¦‚ä½•è®¾ç½®çš„å‘¢ï¼Ÿæ€ä¹ˆé’ˆå¯¹ä¸åŒå¤§å°ï¼Œè®¾ç½®æ˜¾ç¤ºä¸åŒçš„å†…å®¹ï¼Ÿ</p>
<p>è®¾ç½®ä¸åŒå¤§å°ä¸åŒå†…å®¹çš„Widgetï¼Œéœ€è¦ä½¿ç”¨<code>WidgetFamily</code>ï¼Œä½¿ç”¨éœ€è¦å¯¼å…¥<code>WidgetKit</code>ï¼Œæ¯”å¦‚è®¾ç½®Small æ—¶ Meidum çš„å³åŠéƒ¨åˆ†ï¼ŒMedium æ—¶æ˜¾ç¤ºä¸å˜ï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿ</p>
<ol>
<li>åœ¨è¦è®¾ç½®çš„ç±»ä¸­å¯¼å…¥<code>WidgetKit</code></li>
<li>å£°æ˜å±æ€§<code>@Environment(\.widgetFamily) var family: WidgetFamily</code></li>
<li>ä½¿ç”¨<code>Switch</code>æšä¸¾ <code>family</code></li>
</ol>
<p>æ³¨ï¼š</p>
<ul>
<li><code>@Environment</code>æ˜¯ä½¿ç”¨ <code>SwiftUI</code>æœ¬èº«é¢„å®šä¹‰çš„keyï¼Œæ›´å¤šå…³äº<code>@Environment</code>çš„å†…å®¹å¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ä¸ªé“¾æ¥ï¼š<ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/environment">https://developer.apple.com/documentation/swiftui/environment</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/what-is-the-environment-property-wrapper">https://www.hackingwithswift.com/quick-start/swiftui/what-is-the-environment-property-wrapper</a></li>
</ul>
</li>
</ul>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> WidgetKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.widgetFamily) <span class="keyword">var</span> family: <span class="type">WidgetFamily</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;widget_background_test&quot;</span>)</span><br><span class="line">                .resizable()</span><br><span class="line">            <span class="keyword">switch</span> family &#123;</span><br><span class="line">            <span class="keyword">case</span> .systemSmall:</span><br><span class="line">                <span class="type">QQSyncDateShareView</span>()</span><br><span class="line">            <span class="keyword">case</span> .systemMedium:</span><br><span class="line">                <span class="comment">// å·¦å³ä¸¤ä¸ª View</span></span><br><span class="line">                <span class="type">HStack</span> &#123;</span><br><span class="line">                    <span class="comment">// å·¦ View</span></span><br><span class="line">                    <span class="type">QQSyncQuoteTextView</span>()</span><br><span class="line">                                        </span><br><span class="line">                    <span class="comment">// å³ View</span></span><br><span class="line">                    <span class="type">QQSyncDateShareView</span>()</span><br><span class="line">                &#125;</span><br><span class="line">                .padding(<span class="type">EdgeInsets</span>(top: <span class="number">0.0</span>, leading: <span class="number">10.0</span>, bottom: <span class="number">0.0</span>, trailing: <span class="number">10.0</span>))</span><br><span class="line"><span class="comment">//            case .systemLarge:</span></span><br><span class="line"><span class="comment">//                break</span></span><br><span class="line"><span class="comment">//            case .systemExtraLarge:</span></span><br><span class="line"><span class="comment">//                break</span></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="type">QQSyncQuoteTextView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡ŒæŸ¥çœ‹æ•ˆæœï¼Œå¦‚ä¸‹ï¼š</p>
<figure>
    <img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/20220606172328.png" width="70%">
</figure>

<p>å‘ç°æ•ˆæœå’Œé¢„æœŸä¸€æ ·ï¼Œä½†æ˜¯ä»£ç çœ‹èµ·æ¥çœŸçš„æœ‰ç‚¹ä¸‘ï¼ŒåŒæ ·å†ä¼˜åŒ–ä¸€ä¸‹ï¼Œå°è£…<code>QQSyncWidgetMedium</code>å’Œ<code>QQSyncWidgetSmall</code>ä¸¤ä¸ªç±»ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetSmall</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;widget_background_test&quot;</span>)</span><br><span class="line">                .resizable()</span><br><span class="line">            </span><br><span class="line">            <span class="type">QQSyncDateShareView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetMedium</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="comment">// èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">            <span class="type">Image</span>(<span class="string">&quot;widget_background_test&quot;</span>)</span><br><span class="line">                .resizable()</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å·¦å³ä¸¤ä¸ª View</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="comment">// å·¦ View</span></span><br><span class="line">                <span class="type">QQSyncQuoteTextView</span>()</span><br><span class="line"></span><br><span class="line">                <span class="type">Spacer</span>()</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å³ View</span></span><br><span class="line">                <span class="type">QQSyncDateShareView</span>()</span><br><span class="line">            &#125;</span><br><span class="line">            .padding(<span class="type">EdgeInsets</span>(top: <span class="number">0.0</span>, leading: <span class="number">20.0</span>, bottom: <span class="number">0.0</span>, trailing: <span class="number">20.0</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹<code>QQSyncWidgetView</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> WidgetKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Environment</span>(\.widgetFamily) <span class="keyword">var</span> family: <span class="type">WidgetFamily</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> family &#123;</span><br><span class="line">        <span class="keyword">case</span> .systemSmall:</span><br><span class="line">            <span class="type">QQSyncWidgetSmall</span>()</span><br><span class="line">        <span class="keyword">case</span> .systemMedium:</span><br><span class="line">            <span class="type">QQSyncWidgetMedium</span>()</span><br><span class="line"><span class="comment">//            case .systemLarge:</span></span><br><span class="line"><span class="comment">//                break</span></span><br><span class="line"><span class="comment">//            case .systemExtraLarge:</span></span><br><span class="line"><span class="comment">//                break</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="type">QQSyncWidgetMedium</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è¿è¡Œï¼ŒæŸ¥çœ‹æ•ˆæœï¼Œè¿˜æ˜¯é¢„æœŸçš„æ•ˆæœï¼Œä½†æ˜¯ä»£ç çœ‹èµ·æ¥ç®€æ´æ˜äº†äº†ï¼Œå¦‚æœæƒ³è¦æ·»åŠ  Large çš„ Viewï¼Œåªéœ€è¦å†å®šä¹‰<code>QQSyncWidgetLarge</code>ç±»ï¼Œç„¶ååœ¨ä¸Šé¢è¿™ä¸ªåœ°æ–¹ä½¿ç”¨å³å¯ï¼Œæ–¹ä¾¿å¿«æ·ã€‚</p>
<p>æ¥ç€å†æ¥çœ‹ç¬”è€…åˆ›å»ºçš„é¡¹ç›®ï¼Œæ·»åŠ  Widget æ—¶ï¼Œ<code>Small</code>ã€<code>Meidum</code>ã€<code>Large</code>éƒ½æœ‰ï¼Œå³ä½¿åœ¨ä¸Šé¢çš„<code>Switch family</code>ä¸­æ³¨é‡Šæ‰äº†<code>Small</code>å’Œ<code>Larget</code>ï¼Œé¢„è§ˆæ—¶ä»æ—§è¿™ä¸¤ä¸ªå°ºå¯¸ä»æ—§åœ¨ï¼›è€Œå½“æ·»åŠ QQ åŒæ­¥åŠ©æ‰‹çš„ Widget æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„ Widget åªæœ‰ä¸€ä¸ªMediumå°ºå¯¸çš„ï¼Œè¿™åˆæ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯é€šè¿‡ @main å…¥å£å¤„è®¾ç½®<code>supportedFamilies</code>å±æ€§å®ç°çš„ï¼Œ<code>supportedFamilies</code>ä¼ å…¥ä¸€ä¸ªå°ºå¯¸æ•°ç»„ï¼Œä¼ å…¥å‡ ä¸ªå°ºå¯¸åˆ™æ”¯æŒå‡ ä¸ªå°ºå¯¸ï¼Œè€Œå‚ç…§ QQ åŒæ­¥åŠ©æ‰‹çš„æ•ˆæœï¼Œåªä¼ å…¥äº†<code>.systemMedium</code>å°ºå¯¸ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DemoWidget</span>: <span class="title">Widget</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> kind: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;DemoWidget&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">WidgetConfiguration</span> &#123;</span><br><span class="line">        <span class="type">StaticConfiguration</span>(kind: kind, provider: <span class="type">Provider</span>()) &#123; entry <span class="keyword">in</span></span><br><span class="line">            <span class="type">DemoWidgetEntryView</span>(entry: entry)</span><br><span class="line">        &#125;</span><br><span class="line">        .configurationDisplayName(<span class="string">&quot;My Widget&quot;</span>)</span><br><span class="line">        .description(<span class="string">&quot;This is an example widget.&quot;</span>)</span><br><span class="line">        .supportedFamilies([<span class="type">WidgetFamily</span>.systemMedium]) <span class="comment">// è®¾ç½®é¢„è§ˆ widget ä¸­æ”¯æŒçš„å°ºå¯¸æ•°ç»„</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="widget-æ—¥æœŸæ›´æ–°"><a href="#widget-æ—¥æœŸæ›´æ–°" class="headerlink" title="widget æ—¥æœŸæ›´æ–°"></a>widget æ—¥æœŸæ›´æ–°</h4><p>ä¸Šé¢æ˜¾ç¤ºçš„éƒ¨åˆ†å·²ç»å®Œæˆï¼Œæ¥ä¸‹æ¥ï¼Œå†æ¥çœ‹ã€æ—¥æœŸçš„è®¾ç½®ã€‘ï¼Œç›®å‰çš„æ—¥æœŸæ˜¯å›ºå®šçš„ï¼Œå¦‚ä½•è®©æ—¥æœŸå–ç”¨æ‰‹æœºæ—¶é—´ï¼Œè¦æ€ä¹ˆåšï¼Ÿ</p>
<p>éœ€è¦è€ƒè™‘çš„æ˜¯ï¼š</p>
<ul>
<li>æ—¥æœŸä»å“ªé‡Œæ¥ï¼Ÿâ€”â€” å¯ä»¥åœ¨ Extension ä¸­ï¼Œç›´æ¥ä½¿ç”¨ Date()æ¥è·å–åˆ°å½“å‰çš„æ—¥æœŸ</li>
<li>æ—¥æœŸæ›´æ–°äº†æ€ä¹ˆé€šçŸ¥åˆ·æ–°ï¼Ÿå‚è€ƒ<a target="_blank" rel="noopener" href="https://cs193p.sites.stanford.edu/">cs193p-Developing Apps for iOS</a>ï¼Œä½¿ç”¨<code>ObservableObject</code>å®šä¹‰ä¸€ä¸ª<code>@Published</code>ä¿®é¥°çš„å±æ€§ï¼Œç„¶ååœ¨ä½¿ç”¨çš„ Viewä¸­ä½¿ç”¨<code>@ObservedObject</code>ä¿®é¥°çš„å±æ€§ï¼Œè¿™æ ·å½“<code>@Published</code>ä¿®é¥°çš„å±æ€§æœ‰å˜åŒ–æ—¶ï¼Œ<code>@ObservedObject</code>ä¿®é¥°çš„å±æ€§å°±ä¼šå˜åŒ–ï¼Œä»è€Œåˆ·æ–°ç•Œé¢ã€‚</li>
</ul>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<p>é¦–å…ˆåˆ›å»ºswift æ–‡ä»¶ï¼Œæ³¨æ„ï¼Œmodel ç±»åˆ›å»ºä½¿ç”¨çš„ swiftï¼Œè€Œ UIåˆ›å»ºçš„ç±»æ˜¯ SwiftUIã€‚</p>
<p>æ–°å»º<code>String_Extensions.swift</code>ï¼Œå®šä¹‰è·å–æŒ‡å®šæ—¥æœŸç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">DisplayDateType</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Year</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Month</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Day</span></span><br><span class="line">    <span class="keyword">case</span> hour</span><br><span class="line">    <span class="keyword">case</span> minute</span><br><span class="line">    <span class="keyword">case</span> second</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getFormatDateStr</span>(<span class="keyword">_</span> <span class="params">type</span>: <span class="type">DisplayDateType</span>)</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> dateFormatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        dateFormatter.locale <span class="operator">=</span> <span class="type">Locale</span>.current</span><br><span class="line">        dateFormatter.dateFormat <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> formatDate <span class="operator">=</span> dateFormatter.date(from: <span class="keyword">self</span>) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="string">&quot;&quot;</span> &#125;</span><br><span class="line">        <span class="keyword">let</span> calendar <span class="operator">=</span> <span class="type">Calendar</span>.current</span><br><span class="line">        <span class="keyword">_</span> <span class="operator">=</span> calendar.component(.era, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> year <span class="operator">=</span> calendar.component(.year, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> month <span class="operator">=</span> calendar.component(.month, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> day <span class="operator">=</span> calendar.component(.day, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> hour <span class="operator">=</span> calendar.component(.hour, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> minute <span class="operator">=</span> calendar.component(.minute, from: formatDate)</span><br><span class="line">        <span class="keyword">let</span> second <span class="operator">=</span> calendar.component(.second, from: formatDate)</span><br><span class="line">        <span class="keyword">switch</span> type &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Year</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, year)</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Month</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, month)</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Day</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, day)</span><br><span class="line">        <span class="keyword">case</span> .hour:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, hour)</span><br><span class="line">        <span class="keyword">case</span> .minute:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, minute)</span><br><span class="line">        <span class="keyword">case</span> .second:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">String</span>(format: <span class="string">&quot;%.2zd&quot;</span>, second)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getWeekday</span>()</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> dateFormatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        dateFormatter.locale <span class="operator">=</span> <span class="type">Locale</span>.current</span><br><span class="line">        dateFormatter.dateFormat <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> formatDate <span class="operator">=</span> dateFormatter.date(from: <span class="keyword">self</span>) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="string">&quot;&quot;</span> &#125;</span><br><span class="line">        <span class="keyword">let</span> calendar <span class="operator">=</span> <span class="type">Calendar</span>.current</span><br><span class="line">        <span class="keyword">let</span> weekDay <span class="operator">=</span> calendar.component(.weekday, from: formatDate)</span><br><span class="line">        <span class="keyword">switch</span> weekDay &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨æ—¥&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨ä¸€&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨äºŒ&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨ä¸‰&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨å››&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨äº”&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;å‘¨å…­&quot;</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ–°å»º<code>QQSyncWidgetDateItem.swift</code>ç±»ï¼Œç”¨äºè·å–å¹´ã€æœˆã€æ—¥ã€å‘¨ã€æ—¶ã€åˆ†ã€ç§’çš„ String</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncWidgetDateItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> year: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> month: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> day: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> week: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> hour: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> minute: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> second: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">generateItem</span>()</span> -&gt; <span class="type">QQSyncWidgetDateItem</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> dateStr <span class="operator">=</span> date2String(date: <span class="type">Date</span>())</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> year <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.<span class="type">Year</span>)</span><br><span class="line">        <span class="keyword">let</span> month <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.<span class="type">Month</span>)</span><br><span class="line">        <span class="keyword">let</span> day <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.<span class="type">Day</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> week <span class="operator">=</span> dateStr.getWeekday()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> hour <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.hour)</span><br><span class="line">        <span class="keyword">let</span> minute <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.minute)</span><br><span class="line">        <span class="keyword">let</span> second <span class="operator">=</span> dateStr.getFormatDateStr(<span class="type">DisplayDateType</span>.second)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> item <span class="operator">=</span> <span class="type">QQSyncWidgetDateItem</span>(year: year,</span><br><span class="line">                                     month: month,</span><br><span class="line">                                     day: day,</span><br><span class="line">                                     week: week,</span><br><span class="line">                                     hour: hour,</span><br><span class="line">                                     minute: minute,</span><br><span class="line">                                     second: second)</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">date2String</span>(<span class="params">date</span>:<span class="type">Date</span>, <span class="params">dateFormat</span>:<span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> formatter <span class="operator">=</span> <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.locale <span class="operator">=</span> <span class="type">Locale</span>.<span class="keyword">init</span>(identifier: <span class="string">&quot;zh_CN&quot;</span>)</span><br><span class="line">        formatter.dateFormat <span class="operator">=</span> dateFormat</span><br><span class="line">        <span class="keyword">let</span> date <span class="operator">=</span> formatter.string(from: date)</span><br><span class="line">        <span class="keyword">return</span> date</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ–°å»º<code>QQSyncWidgetDateShareItem.swift</code>ï¼Œç±»ä¼¼äº Utilï¼ŒæŠŠ model è½¬ä¸º view ç›´æ¥èƒ½æ˜¾ç¤ºçš„é€»è¾‘å’Œå“åº”ç‚¹å‡»çš„é€»è¾‘éƒ½å¯ä»¥æ”¾å…¥è¿™ä¸ªç±»</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QQSyncWidgetDateShareItem</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">private</span> <span class="keyword">var</span> dateItem <span class="operator">=</span> <span class="type">QQSyncWidgetDateItem</span>.generateItem()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dateShareStr</span>()</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> resultStr <span class="operator">=</span> dateItem.month <span class="operator">+</span> <span class="string">&quot;æœˆ &quot;</span> <span class="operator">+</span> dateItem.week</span><br><span class="line">        <span class="keyword">return</span> resultStr</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">dayStr</span>()</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dateItem.day</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// MARK: action</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹<code>QQSyncDateShareView</code>ç±»ï¼Œæ·»åŠ <code>QQSyncWidgetDateShareItem</code>å±æ€§ï¼Œå›ºå®šçš„æ—¥æœŸæ”¹ä¸ºä»<code>QQSyncWidgetDateShareItem</code>è·å–</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncDateShareView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ObservedObject</span> <span class="keyword">var</span> dateShareItem: <span class="type">QQSyncWidgetDateShareItem</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(dateShareItem.dayStr())</span><br><span class="line">                .font(.system(size: <span class="number">50.0</span>))</span><br><span class="line">                .fontWeight(.semibold)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">                .padding(<span class="type">EdgeInsets</span>(top: <span class="operator">-</span><span class="number">10.0</span>, leading: <span class="number">0.0</span>, bottom: <span class="operator">-</span><span class="number">10.0</span>, trailing: <span class="number">0.0</span>))</span><br><span class="line">            <span class="type">Text</span>(dateShareItem.dateShareStr())</span><br><span class="line">                .lineLimit(<span class="number">1</span>)</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;å»åˆ†äº«&quot;</span>)</span><br><span class="line">                .fixedSize()</span><br><span class="line">                .font(.system(size: <span class="number">14.0</span>))</span><br><span class="line">                .padding(<span class="type">EdgeInsets</span>(top: <span class="number">5.0</span>, leading: <span class="number">20.0</span>, bottom: <span class="number">5.0</span>, trailing: <span class="number">20.0</span>))</span><br><span class="line">                .background(.white)</span><br><span class="line">                .foregroundColor(.black)</span><br><span class="line">                .cornerRadius(<span class="number">12.0</span>)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹æœ‰è°ƒç”¨<code>QQSyncDateShareView</code>çš„åœ°æ–¹ï¼Œ<code>QQSyncWidgetSmall</code>ã€<code>QQSyncWidgetMedium</code>ä¸­éƒ½æ·»åŠ å±æ€§å£°æ˜ä»£ç ï¼Œå¹¶ä¸”ä¿®æ”¹ä¼ å…¥å‚æ•°ï¼›ç„¶åä¿®æ”¹æœ‰å¼•ç”¨è¿™ä¸¤ä¸ªç±»çš„åœ°æ–¹å³<code>QQSyncWidgetView</code>ï¼Œä¹Ÿæ·»åŠ å±æ€§å£°æ˜ä¿®æ”¹ä¼ å…¥å‚æ•°ï¼›æœ€åå†ä¿®æ”¹<code>DemoWidget</code>ç±»ä¸­ä½¿ç”¨äº†<code>DemoWidgetEntryView</code>çš„åœ°æ–¹ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DemoWidgetEntryView</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> entry: <span class="type">Provider</span>.<span class="type">Entry</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">QQSyncWidgetView</span>(dateShareItem: <span class="type">QQSyncWidgetDateShareItem</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€åä¿®æ”¹åˆ·æ–°æ—¶æœºï¼Œå³ä½•æ—¶åˆ·æ–° widget æ•°æ®ï¼Œæ˜¯<code>TimeLineProvider</code>ä¸­çš„<code>getTimeline(in context: Context, completion: @escaping (Timeline&lt;Entry&gt;) -&gt; ())</code>æ–¹æ³•æ§åˆ¶çš„ï¼Œä¿®æ”¹æˆæ¯éš”2ä¸ªå°æ—¶åˆ·æ–°ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getTimeline</span>(<span class="params">in</span> <span class="params">context</span>: <span class="type">Context</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">Timeline</span>&lt;<span class="type">Entry</span>&gt;) -&gt; ())</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> entry <span class="operator">=</span> <span class="type">SimpleEntry</span>(date: <span class="type">Date</span>())</span><br><span class="line">    <span class="comment">// refresh the data every two hours</span></span><br><span class="line">    <span class="keyword">let</span> expireDate <span class="operator">=</span> <span class="type">Calendar</span>.current.date(byAdding: .hour, value: <span class="number">2</span>, to: <span class="type">Date</span>()) <span class="operator">??</span> <span class="type">Date</span>()</span><br><span class="line">    <span class="keyword">let</span> timeline <span class="operator">=</span> <span class="type">Timeline</span>(entries: [entry], policy: .after(expireDate))</span><br><span class="line">    completion(timeline)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿è¡Œè°ƒè¯•ï¼Œä¿®æ”¹æ—¥æœŸï¼Œå°±ä¼šå‘ç°ï¼Œwidget å±•ç¤ºçš„æ—¥æœŸæ•°æ®éšç€æ‰‹æœºæ—¥æœŸçš„ä¿®æ”¹ä¹Ÿè·Ÿç€å˜äº†ï¼Œdoneã€‚</p>
<h4 id="widget-ç½‘ç»œæ•°æ®é€»è¾‘"><a href="#widget-ç½‘ç»œæ•°æ®é€»è¾‘" class="headerlink" title="widget ç½‘ç»œæ•°æ®é€»è¾‘"></a>widget ç½‘ç»œæ•°æ®é€»è¾‘</h4><p>å¯¹æ¯” QQ åŒæ­¥åŠ©æ‰‹çš„ Widgetï¼Œå¯ä»¥å‘ç°ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå›¾ç‰‡å’Œæ–‡å­—å°±è‡ªåŠ¨å˜åŒ–äº†ä¸€æ¬¡ã€‚æ¥ä¸‹æ¥ä¸€èµ·çœ‹ä¸‹è¿™ä¸ªæ•ˆæœæ€ä¹ˆåšï¼ŒèƒŒæ™¯å›¾ç‰‡çš„å˜åŒ–å’Œæ–‡å­—çš„å˜åŒ–ç±»ä¼¼éƒ½æ˜¯ç½‘ç»œè¯·æ±‚ï¼Œç„¶åæ›´æ–°æ•°æ®ï¼Œè¿™é‡Œå°±ä»…ä»¥æ–‡å­—çš„æ›´æ–°ä½œä¸ºç¤ºä¾‹ã€‚</p>
<p>é¦–å…ˆæ‰¾ä¸€ä¸ªéšæœºåè¨€çš„æ¥å£ï¼Œå¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://github.com/vv314/quotes%EF%BC%8C%E8%BF%99%E9%87%8C%E9%80%89%E6%8B%A9%E9%87%8C%E9%9D%A2%E4%B8%80%E8%A8%80%E7%9A%84%E6%8E%A5%E5%8F%A3%EF%BC%8C%E6%8E%A5%E5%8F%A3%E4%B8%BA%EF%BC%9Ahttps://v1.hitokoto.cn/%E3%80%82%E6%8E%A5%E5%8F%A3%E6%89%BE%E5%A5%BD%E4%B9%8B%E5%90%8E%EF%BC%8C%E6%9D%A5%E7%9C%8B%E4%B8%8B">https://github.com/vv314/quotesï¼Œè¿™é‡Œé€‰æ‹©é‡Œé¢ä¸€è¨€çš„æ¥å£ï¼Œæ¥å£ä¸ºï¼šhttps://v1.hitokoto.cn/ã€‚æ¥å£æ‰¾å¥½ä¹‹åï¼Œæ¥çœ‹ä¸‹</a> widget ç½‘ç»œè¯·æ±‚æ€ä¹ˆå®ç°ã€‚</p>
<p>æ–°å»º Network æ–‡ä»¶å¤¹ï¼Œåœ¨ Networkæ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>NetworkClient.swift</code>ï¼Œç”¨äºå°è£…<code>URLSession</code>ç½‘ç»œè¯·æ±‚ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">NetworkClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">URLSession</span> <span class="operator">=</span> .shared</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">NetworkError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> noData</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">executeRequest</span>(<span class="params">request</span>: <span class="type">URLRequest</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">Result</span>&lt;<span class="type">Data</span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>)</span> &#123;</span><br><span class="line">        session.dataTask(with: request) &#123; data, response, error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error <span class="operator">=</span> error &#123;</span><br><span class="line">                completion(.failure(error))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> data <span class="operator">=</span> data <span class="keyword">else</span> &#123;</span><br><span class="line">                completion(.failure(<span class="type">NetworkError</span>.noData))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            completion(.success(data))</span><br><span class="line">        &#125;.resume()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨ Networkæ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>URLRequest+Quote.swift</code>ï¼Œç”¨äºç”ŸæˆQuote çš„ URLRequestï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">URLRequest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">var</span> baseURLStr: <span class="type">String</span> &#123; <span class="keyword">return</span> <span class="string">&quot;https://v1.hitokoto.cn/&quot;</span> &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">quoteFromNet</span>()</span> -&gt; <span class="type">URLRequest</span> &#123;</span><br><span class="line">        .<span class="keyword">init</span>(url: <span class="type">URL</span>(string: baseURLStr)<span class="operator">!</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åå‚ç…§è¿”å›æ•°æ®æ ¼å¼ï¼Œåˆ›å»ºè¿”å›çš„ model ç±»ï¼Œåˆ›å»º<code>QuoteResItem.swift</code>ï¼Œè¿”å›æ•°æ®ä¸­åªç”¨åˆ°äº† hitokotoå­—æ®µï¼Œæ‰€ä»¥åªéœ€è¦å®šä¹‰è¿™ä¸ªå­—æ®µå³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuoteResItem</span>: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     &quot;id&quot;: 6325,</span></span><br><span class="line"><span class="comment">     &quot;uuid&quot;: &quot;2017e206-f81b-48c1-93e3-53a63a9de199&quot;,</span></span><br><span class="line"><span class="comment">     &quot;hitokoto&quot;: &quot;è‡ªè´£è¦çŸ­æš‚ï¼Œä¸è¿‡è¦é•¿ä¹…é“­è®°ã€‚&quot;,</span></span><br><span class="line"><span class="comment">     &quot;type&quot;: &quot;h&quot;,</span></span><br><span class="line"><span class="comment">     &quot;from&quot;: &quot;å½“ä½ æ²‰ç¡æ—¶&quot;,</span></span><br><span class="line"><span class="comment">     &quot;from_who&quot;: null,</span></span><br><span class="line"><span class="comment">     &quot;creator&quot;: &quot;æ²ˆæ—¶ç­ &quot;,</span></span><br><span class="line"><span class="comment">     &quot;creator_uid&quot;: 6568,</span></span><br><span class="line"><span class="comment">     &quot;reviewer&quot;: 1,</span></span><br><span class="line"><span class="comment">     &quot;commit_from&quot;: &quot;web&quot;,</span></span><br><span class="line"><span class="comment">     &quot;created_at&quot;: &quot;1593237879&quot;,</span></span><br><span class="line"><span class="comment">     &quot;length&quot;: 14</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> hitokoto: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é»˜è®¤ç”Ÿæˆå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">generateItem</span>()</span> -&gt; <span class="type">QuoteResItem</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> item <span class="operator">=</span> <span class="type">QuoteResItem</span>(hitokoto: <span class="string">&quot;æ‰€æœ‰å¿«ä¹éƒ½å‘ä½ é æ‹¢ï¼Œæ‰€æœ‰å¥½è¿éƒ½åœ¨è·¯ä¸Š&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†åœ¨åœ¨ Networkæ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>QuoteService.swift</code>ï¼Œå®šä¹‰å¤–éƒ¨è°ƒç”¨çš„æ¥å£ï¼Œå†…éƒ¨å°è£…è¯·æ±‚é€»è¾‘ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">QuoteService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">getQuote</span>(<span class="params">client</span>: <span class="type">NetworkClient</span>, <span class="params">completion</span>: ((<span class="type">QuoteResItem</span>) -&gt; <span class="type">Void</span>)<span class="operator">?</span>)</span> &#123;</span><br><span class="line">        quoteRequest(.quoteFromNet(),</span><br><span class="line">                     on: client,</span><br><span class="line">                     completion: completion)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">quoteRequest</span>(<span class="keyword">_</span> <span class="params">request</span>: <span class="type">URLRequest</span>,</span></span><br><span class="line"><span class="function">                                     <span class="params">on</span> <span class="params">client</span>: <span class="type">NetworkClient</span>,</span></span><br><span class="line"><span class="function">                                     <span class="params">completion</span>: ((<span class="type">QuoteResItem</span>) -&gt; <span class="type">Void</span>)<span class="operator">?</span>)</span> &#123;</span><br><span class="line">        client.executeRequest(request: request) &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> result &#123;</span><br><span class="line">            <span class="keyword">case</span> .success(<span class="keyword">let</span> data):</span><br><span class="line">                <span class="keyword">let</span> decoder <span class="operator">=</span> <span class="type">JSONDecoder</span>()</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> quoteItem <span class="operator">=</span> <span class="keyword">try</span> decoder.decode(<span class="type">QuoteResItem</span>.<span class="keyword">self</span>, from: data)</span><br><span class="line">                    completion<span class="operator">?</span>(quoteItem)</span><br><span class="line">                &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                    <span class="built_in">print</span>(error.localizedDescription)</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                <span class="built_in">print</span>(error.localizedDescription)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åæ·»åŠ è°ƒç”¨çš„å…¥å£ï¼Œåœ¨æ·»åŠ è°ƒç”¨ä¹‹å‰ï¼Œéœ€è¦è€ƒè™‘ä¸‹ä½¿ç”¨çš„åœºæ™¯ï¼Œå’Œæ—¥æœŸç›¸åŒï¼Œå®šä¹‰ä¸€ä¸ª Publishedä¿®é¥°çš„å±æ€§ï¼Œç„¶ååœ¨ä½¿ç”¨çš„åœ°æ–¹ï¼Œä½¿ç”¨å®šä¹‰@ObservedObjectä¿®é¥°çš„å±æ€§æ¥ç›‘å¬å˜åŒ–ã€‚</p>
<p>åˆ›å»º<code>QQSyncWidgetQuoteShareItem.swift</code>ï¼Œç”¨äºå¤„ç† Quoteçš„æ•°æ®ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QQSyncWidgetQuoteShareItem</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Published</span> <span class="keyword">private</span> <span class="keyword">var</span> quoteItem <span class="operator">=</span> <span class="type">QuoteResItem</span>.generateItem()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">quoteStr</span>()</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> quoteItem.hitokoto</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">updateQuoteItem</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">QuoteResItem</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.quoteItem <span class="operator">=</span> item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨<code>QQSyncQuoteTextView.swift</code>ä¸­æ·»åŠ å±æ€§ï¼Œå¹¶ä¿®æ”¹ä½¿ç”¨ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QQSyncQuoteTextView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ObservedObject</span> <span class="keyword">var</span> quoteShareItem: <span class="type">QQSyncWidgetQuoteShareItem</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            <span class="type">Text</span>(quoteShareItem.quoteStr())</span><br><span class="line">                .font(.system(size: <span class="number">19.0</span>))</span><br><span class="line">                .fontWeight(.semibold)</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">            </span><br><span class="line">            <span class="type">Text</span>(<span class="string">&quot;åŠ æ²¹ï¼Œæ‰“å·¥äººï¼ğŸ˜„&quot;</span>)</span><br><span class="line">                .font(.system(size: <span class="number">16.0</span>))</span><br><span class="line">                .minimumScaleFactor(<span class="number">0.5</span>)</span><br><span class="line">                .foregroundColor(.white)</span><br><span class="line">            <span class="type">Spacer</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¿®æ”¹<code>QQSyncWidgetMedium.swift</code>å’Œ<code>QQSyncWidgetView.swift</code>ä¸­çš„æŠ¥é”™ï¼Œå’Œä¸Šé¢ç±»ä¼¼ï¼Œæ·»åŠ <code>@ObservedObject var quoteShareItem: QQSyncWidgetQuoteShareItem</code>ï¼Œä¿®æ”¹ä¼ å…¥å‚æ•°ã€‚</p>
<p>æœ€åå†ä¿®æ”¹<code>DemoWidget.swift</code></p>
<ul>
<li>ä¿®æ”¹<code>SimpleEntry</code>ï¼Œæ·»åŠ å®šä¹‰çš„<code>QQSyncWidgetQuoteShareItem</code>å±æ€§</li>
<li>ä¿®æ”¹<code>DemoWidgetEntryView</code>ï¼Œæ·»åŠ ä¼ å…¥å‚æ•°<code>entry.quoteShareItem</code></li>
<li>ä¿®æ”¹<code>Provider</code><ul>
<li><code>placeholder(in context: Context) -&gt; SimpleEntry</code>æ·»åŠ ä¼ å…¥å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤å€¼</li>
<li><code>getSnapshot(in context: Context, completion: @escaping (SimpleEntry) -&gt; ())</code>æ·»åŠ ä¼ å…¥å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤å€¼</li>
<li><code>getTimeline(in context: Context, completion: @escaping (Timeline&lt;Entry&gt;) -&gt; ())</code>æ–¹æ³•â€”â€”æ·»åŠ ç½‘ç»œè¯·æ±‚çš„è°ƒç”¨ï¼Œç”¨ç½‘ç»œè¿”å›å¯¹è±¡ç”Ÿæˆå¯¹åº”çš„<code>QQSyncWidgetQuoteShareItem</code>ï¼Œä¼ å…¥å‚æ•°ä½¿ç”¨ç”Ÿæˆçš„ item</li>
</ul>
</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Provider</span>: <span class="title">TimelineProvider</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">placeholder</span>(<span class="params">in</span> <span class="params">context</span>: <span class="type">Context</span>)</span> -&gt; <span class="type">SimpleEntry</span> &#123;</span><br><span class="line">        <span class="type">SimpleEntry</span>(date: <span class="type">Date</span>(), quoteShareItem: <span class="type">QQSyncWidgetQuoteShareItem</span>())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getSnapshot</span>(<span class="params">in</span> <span class="params">context</span>: <span class="type">Context</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">SimpleEntry</span>) -&gt; ())</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> entry <span class="operator">=</span> <span class="type">SimpleEntry</span>(date: <span class="type">Date</span>(), quoteShareItem: <span class="type">QQSyncWidgetQuoteShareItem</span>())</span><br><span class="line">        completion(entry)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getTimeline</span>(<span class="params">in</span> <span class="params">context</span>: <span class="type">Context</span>, <span class="params">completion</span>: <span class="keyword">@escaping</span> (<span class="type">Timeline</span>&lt;<span class="type">Entry</span>&gt;) -&gt; ())</span> &#123;</span><br><span class="line">        <span class="type">QuoteService</span>.getQuote(client: <span class="type">NetworkClient</span>()) &#123; quoteResItem <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> quoteShareItem <span class="operator">=</span> <span class="type">QQSyncWidgetQuoteShareItem</span>()</span><br><span class="line">            quoteShareItem.updateQuoteItem(quoteResItem)</span><br><span class="line">            <span class="keyword">let</span> entry <span class="operator">=</span> <span class="type">SimpleEntry</span>(date: <span class="type">Date</span>(), quoteShareItem: quoteShareItem)</span><br><span class="line">            <span class="comment">// refresh the data every two hours</span></span><br><span class="line">            <span class="keyword">let</span> expireDate <span class="operator">=</span> <span class="type">Calendar</span>.current.date(byAdding: .hour, value: <span class="number">2</span>, to: <span class="type">Date</span>()) <span class="operator">??</span> <span class="type">Date</span>()</span><br><span class="line">            <span class="keyword">let</span> timeline <span class="operator">=</span> <span class="type">Timeline</span>(entries: [entry], policy: .after(expireDate))</span><br><span class="line">            completion(timeline)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SimpleEntry</span>: <span class="title">TimelineEntry</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> date: <span class="type">Date</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> quoteShareItem: <span class="type">QQSyncWidgetQuoteShareItem</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DemoWidgetEntryView</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> entry: <span class="type">Provider</span>.<span class="type">Entry</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">QQSyncWidgetView</span>(dateShareItem: <span class="type">QQSyncWidgetDateShareItem</span>(), quoteShareItem: entry.quoteShareItem)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è°ƒè¯•æŸ¥çœ‹æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°æ˜¾ç¤ºçš„æ–‡æ¡ˆå·²ç»æ”¹å˜ï¼Œè¯´æ˜å·²ç»ä½¿ç”¨äº†ç½‘ç»œè¿”å›çš„æ•°æ®ï¼›è¿˜å¯ä»¥æµ‹è¯•ä¸€ä¸‹ widget åˆ·æ–°çš„æ—¶æœºï¼Œä¸Šé¢çš„ä»£ç ä¸­è®¾ç½®äº†æ¯éš”ä¸¤ä¸ªå°æ—¶åˆ·æ–°ä¸€ä¸‹ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ‰‹æœºæ—¶é—´è°ƒåä¸¤ä¸ªå°æ—¶ï¼Œç„¶åå†æ¥æŸ¥çœ‹ä¸‹ widget æ•ˆæœï¼Œå¯ä»¥å‘ç°æ–‡å­—å‘ç”Ÿäº†æ”¹å˜ï¼Œè¯´æ˜åˆ·æ–°äº†æ•°æ®ï¼Œèµï¼Œå®Œæˆã€‚</p>
<p>æœ€ç»ˆå®Œæ•´æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/mokong/BlogImages/main/img/RPReplay_Final1654600687.gif" alt="æœ€ç»ˆæ•ˆæœ"></p>
<p>å®Œæ•´ä»£ç å·²æ”¾åœ¨ï¼š<a target="_blank" rel="noopener" href="https://github.com/mokong/WidgetAllInOne">Github</a>ä¸­ <code>Tutorial2-QQ åŒæ­¥åŠ©æ‰‹ widget</code>ï¼Œé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/mokong/WidgetAllInOne">https://github.com/mokong/WidgetAllInOne</a></p>
<p>ä¸‹ä¸€ç¯‡ï¼Œ ä¼šå…ˆè®² WidgetBundle çš„ä½¿ç”¨ï¼Œç„¶åå†è®²æ€ä¹ˆå®ç°ä¸€ä¸ªæ”¯ä»˜å® Widgetæ•ˆæœã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://cs193p.sites.stanford.edu/">cs193p-Developing Apps for iOS</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/swiftui/environment">Environment</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/quick-start/swiftui/what-is-the-environment-property-wrapper">What is the @Environment property wrapper?</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/94d4106b9298">Appä¹‹é—´çš„æ•°æ®å…±äº«â€”â€”App Groupçš„é…ç½®</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/widgetkit/making-a-configurable-widget">Making a Configurable Widget</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oliverbinns.co.uk/2020/06/27/create-a-tube-status-home-screen-widget-for-ios-14/">Create a Tube Status home-screen Widget for iOS 14</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/65558991/reorderable-intent-configuration-widget-ios">Reorderable intent configuration widget iOS</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://morganwang.cn">ä»Šæ˜¯æ˜¨é</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://morganwang.cn/2022/05/06/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%88%9B%E5%BB%BA%E6%94%AF%E4%BB%98%E5%AE%9D%20Widget/">http://morganwang.cn/2022/05/06/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%88%9B%E5%BB%BA%E6%94%AF%E4%BB%98%E5%AE%9D%20Widget/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="http://morganwang.cn" target="_blank">ä»Šæ˜¯æ˜¨éçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a><a class="post-meta__tags" href="/tags/iOS/">iOS</a></div><div class="post-share"><div class="social-share" data-image="/assets/img/avatar.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/05/23/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9mac%E5%BA%94%E7%94%A8%E5%88%9B%E5%BB%BA/" title="å›¾ç‰‡å‹ç¼© mac åº”ç”¨å¼€å‘"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">å›¾ç‰‡å‹ç¼© mac åº”ç”¨å¼€å‘</div></div><div class="info-2"><div class="info-item-1">å›¾ç‰‡å‹ç¼© mac åº”ç”¨å¼€å‘èƒŒæ™¯3å¹´å‰æœ‰ä¸ªé¡¹ç›®BatchProssImageï¼Œä½¿ç”¨ Python å†™çš„æ‰¹é‡å‹ç¼©å›¾ç‰‡çš„ï¼Œæœ€æ–°å†æ¬¡ä½¿ç”¨æ—¶ï¼Œå‘ç°å¿˜è®°äº†æ€ä¹ˆä½¿ç”¨ï¼Œæ‰€ä»¥å°±æœ‰äº†æŠŠè¿™ä¸ªPython å®ç°çš„å·¥å…·ï¼Œåšæˆä¸€ä¸ªç®€å•çš„ mac app çš„æƒ³æ³•ã€‚   è¿‡ç¨‹æƒ³æ³•å¾ˆç®€å•ï¼šå°è±¡ä¸­å½“æ—¶è¿™ä¸ªå·¥å…·æ˜¯ä½¿ç”¨ tinypng çš„ api å‹ç¼©çš„ï¼Œæ‰€ä»¥å¼€å‘ä¸€ä¸ª macå®¢æˆ·ç«¯ï¼Œè°ƒç”¨å‹ç¼©çš„æ¥å£ï¼Œå¯¼å‡ºç…§ç‰‡å°±å¯ä»¥ã€‚å¼€å§‹åŠ¨å·¥ã€‚ é¦–å…ˆ mac å®¢æˆ·ç«¯çš„ UI ä»å“ªé‡Œæ¥ï¼Ÿä¹‹å‰æœ‰ä¸ªé¡¹ç›®OtoolAnalyseâ€”â€”åˆ†æMach-Oæ–‡ä»¶ä¸­æ— ç”¨çš„ç±»å’Œæ–¹æ³•ï¼Œæ˜¯å€ŸLinkMapUI æ¥å®ç°çš„ã€‚è¿™é‡Œæƒ³äº†æƒ³ï¼Œå—¯ï¼Œè¿˜å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚æ‰“å¼€é¡¹ç›®ä¸€çœ‹ï¼ŒOC çš„ï¼Œè¿˜æ˜¯ç”¨ Swift å†™ä¸€éå§ã€‚ UI å®ç°æƒ³ä¸€ä¸‹å¤§è‡´éœ€è¦å“ªäº›åŠŸèƒ½ï¼Œ  é€‰æ‹©æ–‡ä»¶ || ç›®å½• é€‰æ‹©å¯¼å‡ºç›®å½• å¼€å§‹å‹ç¼© å‹ç¼©è¿›åº¦æ˜¾ç¤º å™¢å™¢ï¼Œè¿˜æœ‰ä¸€ä¸ªï¼Œtinypng apikey è¾“å…¥  å†è€ƒè™‘ä¸€ä¸‹ï¼Œé€‰æ‹©å¯¼å‡ºç›®å½•æ˜¯å¦å¿…è¦ï¼Ÿä¹‹å‰ç¬”è€…è‡ªå·±ä½¿ç”¨å…¶ä»– APP é€‰æ‹©å¯¼å‡ºæ—¶ï¼Œæ‰“æ–­å…ˆæœ‰çš„æ“ä½œä¸”ä¸è¯´ï¼Œå¯¹äºé€‰æ‹©å›°éš¾æ¥è¯´ï¼Œæ¯æ¬¡è€ƒè™‘è¦å¯¼å‡ºåˆ°å“ªé‡Œéƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œè¦ä¸è¦æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿˜é€‰æ‹©åŒç›®å½•ä¼šæ˜¯ä»€ä¹ˆæ•ˆæœç­‰ç­‰ã€‚ æ”¹ä¸º ...</div></div></div></a><a class="pagination-related" href="/2022/04/26/24%E7%82%B9%E7%AE%97%E6%B3%95Swift%20%E5%AE%9E%E7%8E%B0/" title="ã€Š24ç‚¹ã€‹APPâ€”â€”æç¤ºåŠŸèƒ½çš„å®ç°"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">ã€Š24ç‚¹ã€‹APPâ€”â€”æç¤ºåŠŸèƒ½çš„å®ç°</div></div><div class="info-2"><div class="info-item-1">æ›´æ–°ï¼šã€Š24ç‚¹ã€‹APPâ€”â€”æç¤ºåŠŸèƒ½å®ç°èƒŒæ™¯å•†åº—é‡Œæ‰€æœ‰24ç‚¹ APP çš„ä¸€ä¸ªä»˜è´¹åŠŸèƒ½æ˜¯æç¤ºçš„è·å–ï¼Œä¼šé€šè¿‡é™åˆ¶æç¤ºæ¬¡æ•°ï¼Œè¶…å‡ºæ¬¡æ•°åè§‚çœ‹å¹¿å‘Šæˆ–è€…è´­ä¹°æ¥è§£é”é¢å¤–æ¬¡æ•°ã€‚æ¯”å¦‚ï¼š     è¿™é‡Œå°±æ¥åˆ†äº«ä¸€ä¸‹ï¼Œç±»ä¼¼24ç‚¹çš„æç¤ºåŠŸèƒ½æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå…¶å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š æ­¥éª¤ä¸€ï¼šåˆ¤æ–­ç»“æœèƒ½ä¸èƒ½ç­‰äº24ï¼› æ­¥éª¤äºŒï¼šå¦‚æœèƒ½ç­‰äº24ï¼Œæ˜¾ç¤ºå‡ºèƒ½å¾—åˆ°24çš„è¡¨è¾¾å¼ã€‚ ä¸‹é¢è¯¦ç»†è®°å½•ä¸€ä¸‹å®ç°çš„è¿‡ç¨‹ï¼š è§£æ³•åŸç†æ­¥éª¤ä¸€ï¼Œåˆ¤æ–­èƒ½ä¸èƒ½ç­‰äº24æœ‰[a, b, c, d] å››ä¸ªæ•°å­—ï¼Œä»»å–ä¸¤ä¸ªæ•°å­—ï¼Œé€šè¿‡éå†è¿ç®—ç¬¦å¾—åˆ°è¿ç®—ç»“æœ eï¼Œç„¶åæŠŠè¿ç®—ç»“æœå’Œå‰©ä½™çš„æ•°å­—æ”¾å…¥æ–°çš„æ•°ç»„ä¸­ï¼Œé‡å¤ä¸Šé¢çš„è®¡ç®—è¿‡ç¨‹ï¼Œç›´åˆ°æ•°ç»„ä¸­æœ‰ä¸€ä¸ªå…ƒç´ ä¸ºæ­¢ï¼›æœ€ååˆ¤æ–­æ•°ç»„ä¸­å”¯ä¸€çš„æ•°å­—æ˜¯å¦ç­‰äº24å³å¯ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„å‡ ç‚¹ï¼Œä¸€æ˜¯éå†è¿ç®—ç¬¦çš„æ—¶å€™ï¼ŒåŠ å’Œä¹˜ç¬¦åˆäº¤æ¢å¾‹ï¼Œæ‰€ä»¥ä¸éœ€è¦é‡å¤è®¡ç®—ï¼›äºŒæ˜¯é™¤æ³•ä¼šæœ‰å°æ•°ï¼Œæ‰€ä»¥æœ€ç»ˆåˆ¤æ–­æ˜¯å¦ç­‰äº24çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡è®¾ç½®è¯¯å·®èŒƒå›´æ¥åˆ¤æ–­ï¼›å†æœ‰å°±æ˜¯é™¤æ³•çš„é™¤æ•°ä¸èƒ½ä¸ºé›¶ã€‚ æ‰€ä»¥æœ€ç»ˆè§£æ³•æè¿°å¦‚ä¸‹ï¼š  å®šä¹‰è¯¯å·®èŒƒå›´ï¼Œå®šä¹‰è¦å¯¹æ¯”çš„å€¼ï¼Œå®šä¹‰è¿ç®—ç¬¦æ•°ç»„ï¼› å®šä¹‰åˆ¤æ–­æ˜¯å¦ç›¸ç­‰çš„åˆ¤æ–­æ–¹æ³•ï¼Œä¼ å…¥å€¼å’Œè¦å¯¹æ¯”çš„å€¼çš„ç»å¯¹å€¼å°äºè¯¯å·®èŒƒå›´ï¼Œå³è§†ä½œç›¸ç­‰ï¼› æ•°æ®è½¬æ¢ï¼Œç”±äºä¼ å…¥çš„æ•°å­—æ˜¯Intï¼Œæ‰€ä»¥é€šè¿‡...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/01/21/%E8%BF%9E%E5%A4%9C%E5%BC%80%E5%8F%91%E4%BA%86%E4%B8%80%E4%B8%AA%20Mac%20%E4%B8%8A%E4%B9%85%E5%9D%90%E6%8F%90%E9%86%92%E5%B7%A5%E5%85%B7/" title="è¿å¤œå¼€å‘äº†ä¸€ä¸ª Mac ä¸Šä¹…åæé†’å·¥å…·"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-21</div><div class="info-item-2">è¿å¤œå¼€å‘äº†ä¸€ä¸ª Mac ä¸Šä¹…åæé†’å·¥å…·</div></div><div class="info-2"><div class="info-item-1">èƒŒæ™¯çœ‹åˆ°# Mac ç«¯ï¼Œå®šæ—¶æé†’ä¼‘æ¯ï¼Œæ±‚å®‰åˆ©æƒ³åˆ°è‡ªå·±ä¹Ÿéœ€è¦ä¸€ä¸ªç±»ä¼¼çš„æé†’ï¼Œæ‰€ä»¥è¿å¤œè®©AIå¼€å‘äº†ä¸€ä¸ªï¼Œå“ˆå“ˆå“ˆï¼Œé™„åŠ äº†å–æ°´å’Œæè‚›æé†’ï¼ˆè¢«æŒ‡åˆ°çš„è¦æè‚›10ä¸‹ï¼‰ã€‚ã€‚ã€‚      å®ç°ç•Œé¢å¦‚ä¸‹ï¼Œä¸‹è½½åœ°å€ï¼š[BreakReminder](https://apps.apple.com/us/app/breakreminder/id6758083688?mt=12BreakReminder)    å‚è€ƒ</div></div></div></a><a class="pagination-related" href="/2023/04/06/Xcode%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE%E9%BB%98%E8%AE%A4%E6%96%87%E6%A1%88%E4%BF%AE%E6%94%B9/" title="Xcode åˆ›å»ºé¡¹ç›®é»˜è®¤æ–‡æ¡ˆä¿®æ”¹"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-06</div><div class="info-item-2">Xcode åˆ›å»ºé¡¹ç›®é»˜è®¤æ–‡æ¡ˆä¿®æ”¹</div></div><div class="info-2"><div class="info-item-1">èƒŒæ™¯æœ€è¿‘éœ€è¦ä¿®æ”¹Xcodeåˆ›å»ºé¡¹ç›®é»˜è®¤æ–‡æ¡ˆä¿®æ”¹ï¼Œå°±æ˜¯æ¯æ¬¡åˆ›å»ºæœ€ä¸Šé¢é»˜è®¤ç”Ÿæˆçš„æ³¨é‡Šè¯´æ˜ã€‚æƒ³èµ·æ¥ä¹‹å‰çœ‹åŸRaywenderlichï¼ˆç°åœ¨æ˜¯Kodecoï¼‰ç½‘ç«™ä¸‹è½½çš„ä»£ç æ—¶ï¼Œæ¯ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶é‡Œéƒ½æœ‰ä¸€é•¿ä¸²è‡ªå®šä¹‰çš„è¯´æ˜ï¼Œè€Œä¸”æ–°å»ºæ–‡ä»¶çš„æ—¶å€™ä¹Ÿæ˜¯å¸¦æœ‰åŒæ ·çš„è‡ªå®šä¹‰çš„è¯´æ˜ï¼Œæœ‰è¿‡ç–‘æƒ‘ï¼Œä½†æ˜¯æ²¡æœ‰ä»”ç»†ç ”ç©¶ï¼Œä»Šå¤©ç ”ç©¶ä¸‹æ€ä¹ˆå®ç°çš„ï¼š   Kodecoæ–‡ä»¶è‡ªå®šä¹‰çš„è¯´æ˜å¦‚ä¸‹ï¼š  å®ç°é€šè¿‡Customize text macroså’ŒText macros reference å¯ä»¥çœ‹å‡ºï¼ŒXcodeé»˜è®¤å¤´éƒ¨æ–‡å­—æ³¨é‡Šé»˜è®¤å®šä¹‰å¦‚ä¸‹ï¼š 12345678//  ___FILENAME___//  ___PACKAGENAME___////  Created by ___FULLUSERNAME___ on ___DATE___.//  ___COPYRIGHT___//  ç„¶åå‚è€ƒCustomizing the file header comment and other text macros in Xcode 9 å¯ä»¥ç¡®å®šä¿®æ”¹çš„æ­¥éª¤æ˜¯:  åˆ›å»ºIDETemplateMacros.plist æ·»åŠ æˆ–ä¿®æ”¹Rootå¯¹åº”çš„typeä¸º...</div></div></div></a><a class="pagination-related" href="/2024/02/19/RxSwfit%E5%AE%9E%E7%8E%B0%E6%90%9C%E7%B4%A2/" title="RxSwfit ä½¿ç”¨"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-19</div><div class="info-item-2">RxSwfit ä½¿ç”¨</div></div><div class="info-2"><div class="info-item-1">RxSwiftä½¿ç”¨å¤‡å¿˜RxSwift å¸¸ç”¨æ–¹æ³•ä½¿ç”¨ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚   RxSwfitå®ç°æœç´¢distinctUntilChangedçš„ä½œç”¨æ˜¯ï¼Œç›¸é‚»çš„é‡å¤äº‹ä»¶ä¸äº§ç”Ÿæ–°çš„äº‹ä»¶ï¼Œæ‰€ä»¥æœç´¢ä¸­ä½¿ç”¨distinctUntilChangedå¯ä»¥ä¿è¯åªæœ‰æ¯æ¬¡è§¦å‘çš„æœç´¢éƒ½æ˜¯ä¸åŒçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä¿è¯è¾“å…¥åœæ­¢ååªä¼šè§¦å‘ä¸€æ¬¡æœç´¢ã€‚ throttle å’Œ debounce çš„åŒºåˆ«ï¼š  throttle æ¯éš”å›ºå®šæ—¶é—´è°ƒç”¨ debounce äº‹ä»¶åœæ­¢åéš”å¤šå°‘ç§’è°ƒç”¨  æ‰€ä»¥ï¼Œå¦‚æœéœ€è¦å®ç°è¾“å…¥ä¸­æœç´¢ï¼Œä½¿ç”¨ throttle  1234567891011fileprivate func configureSearch() &#123;  searchBar.rx.text        .orEmpty        .throttle(1.0, scheduler: MainScheduler.instance)        .distinctUntilChanged()        .subscribe &#123; [unowned self] (query) in                   ...</div></div></div></a><a class="pagination-related" href="/2021/05/12/iOS%20mach-o%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90%E5%A4%9A%E4%BD%99%E7%9A%84%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/" title="iOS mach-oæ–‡ä»¶åˆ†æå¤šä½™çš„ç±»å’Œæ–¹æ³•"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-12</div><div class="info-item-2">iOS mach-oæ–‡ä»¶åˆ†æå¤šä½™çš„ç±»å’Œæ–¹æ³•</div></div><div class="info-2"><div class="info-item-1">mach-oæ–‡ä»¶åˆ†æå¤šä½™çš„ç±»å’Œæ–¹æ³•.mdèƒŒæ™¯æœ€è¿‘åšåŒ…å¤§å°ä¼˜åŒ–ï¼Œåœ¨åšé¡¹ç›®ä»£ç ä¼˜åŒ–æ—¶ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªè¿‡ç¨‹æ˜¯åˆ†æMach-Oæ–‡ä»¶ï¼Œçœ‹ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½è¯´é€šè¿‡otoolåˆ†æMach-Oï¼Œè·å–__objc_classrefsã€__objc_classlistç­‰ï¼Œç„¶åæ‰¾å‡ºæ— ç”¨ç±»å’Œæ— ç”¨æ–¹æ³•ã€‚   æ¯”å¦‚ï¼šæ— ç”¨ç±»é€šè¿‡ otool é€†å‘Mach-Oæ–‡ä»¶ __DATA.__objc_classlistæ®µå’Œ__DATA.__objc_classrefs æ®µè·å–æ‰€æœ‰ OC ç±»å’Œè¢«å¼•ç”¨çš„ç±»ï¼Œä¸¤ä¸ªé›†åˆå·®å€¼ä¸ºæ— ç”¨ç±»é›†åˆï¼Œç»“åˆ nm -nm å¾—åˆ°åœ°å€å’Œå¯¹åº”ç±»åç¬¦å·åŒ–æ— ç”¨ç±»ç±»åæ¥è‡ªå¹²è´§ï¼äº¬ä¸œå•†åŸiOS Appç˜¦èº«å®è·µ åˆæˆ–è€…ç»“åˆLinkMapæ–‡ä»¶çš„__TEXT.__textï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼([+|-][.+\s(.+)])ï¼Œæˆ‘ä»¬å¯ä»¥æå–å½“å‰å¯æ‰§è¡Œæ–‡ä»¶é‡Œæ‰€æœ‰objcç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼ˆSelectorsAllï¼‰ã€‚å†ä½¿ç”¨otoolå‘½ä»¤otool -v -s __DATA __objc_selrefsé€†å‘__DATA.__objc_selrefsæ®µï¼Œæå–å¯æ‰§è¡Œæ–‡ä»¶é‡Œå¼•ç”¨åˆ°çš„æ–¹æ³•åï¼ˆUsedSelectorsAllï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´åˆ†...</div></div></div></a><a class="pagination-related" href="/2025/08/20/Xcode26%E7%BC%96%E8%AF%91%E5%A4%B1%E8%B4%A5%E4%BF%AE%E6%94%B9/" title="Xcode 26ç¼–è¯‘å¤±è´¥ä¿®æ”¹"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-20</div><div class="info-item-2">Xcode 26ç¼–è¯‘å¤±è´¥ä¿®æ”¹</div></div><div class="info-2"><div class="info-item-1">èƒŒæ™¯ç”µè„‘å‡çº§MacOS 26.0ï¼Œæ–°å¢äº†ä¸€ä¸ªSDKåï¼ŒXcode26 Beta5å’ŒBeta6ï¼Œç¼–è¯‘é¡¹éƒ½æŠ¥é”™ï¼Œæç¤ºï¼šAssertion failed: (it != _dylibToOrdinal.end()), function dylibToOrdinal, file OutputFile.cpp, line 5196.   æ’æŸ¥è¿‡ç¨‹ åœ¨StackOverFlowä¸Šæœ‰çœ‹åˆ°è¯´ENABLE_DEBUG_DYLIB=NOï¼Œå°è¯•åæ— æ•ˆæœ åœ¨Xcode 26 Link Errorä¸­çœ‹åˆ°ï¼ŒAppleå®˜æ–¹äººå‘˜çš„å›å¤ï¼Œè¦æ·»åŠ -Xlinker -dead_strip -Xlinker -allow_dead_duplicates.  è§£å†³åŠæ³•é€šè¿‡ Other Linker Flags ä¿®æ”¹è¿›å…¥ Target çš„ Build Settings æ ‡ç­¾ï¼šé€‰ä¸­ Target â†’ Build Settings â†’ æœç´¢ Other Linker Flagsã€‚æ‰‹åŠ¨ä¿®æ”¹é“¾æ¥å‚æ•°ï¼šç‚¹å‡» Other Linker Flagsï¼Œé¦–å…ˆç§»é™¤ 12-ld64 -ld_classic  ç„¶åæ·»åŠ  1234-Xlinker ...</div></div></div></a><a class="pagination-related" href="/2024/11/19/%E5%9B%BD%E8%A1%8CXcode%20%E4%BD%BF%E7%94%A8%20AI/" title="å›½è¡ŒMac å¼€å¯ Xcode inteligence æç¤º"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-19</div><div class="info-item-2">å›½è¡ŒMac å¼€å¯ Xcode inteligence æç¤º</div></div><div class="info-2"><div class="info-item-1">èƒŒæ™¯ç”µè„‘å›½è¡Œ Mac M1ï¼Œå†…å­˜ 16Gï¼Œç‰ˆæœ¬ Sequoia 15.1ï¼ŒXcode 16.1ï¼Œåœ¨Xcode è®¾ç½®ä¸­ï¼ŒText Editing ä¸‹ï¼ŒEditing Tabä¸‹ï¼Œèƒ½çœ‹åˆ°æœ‰ä¸ªè®¾ç½®Predictive code completionï¼Œä½†æ˜¯é»˜è®¤æ˜¯å…³é—­çš„ï¼Œ å›½è¡Œçš„æç¤ºä¸æ”¯æŒï¼Œè¿™é‡Œè¯´çš„æ˜¯æ€ä¹ˆå¼€å¯è¿™ä¸ªï¼Œäº²æµ‹å¼€å¯æˆåŠŸã€‚   æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š    æ­¥éª¤å‚è€ƒXcodeLLMEligibleï¼Œæˆ‘ç”¨çš„æ˜¯ä¸ disable sip çš„æ–¹å¼ã€‚ é¦–å…ˆï¼Œåœ¨ç»ˆç«¯ä¸­ï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤ï¼š 12345678# Override XcodeLLM onlycurl -L https://raw.githubusercontent.com/Kyle-Ye/XcodeLLMEligible/release/0.2/scripts/override.sh | bash -s -- install override xcodellm# Override Apple Intelligence onlycurl -L https://raw.githubusercontent.com/Kyle-Ye/XcodeLLMEli...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/assets/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ä»Šæ˜¯æ˜¨é</div><div class="author-info-description">æŠ€æœ¯åˆ†äº«ã€ç”Ÿæ´»æ„Ÿæ‚Ÿ</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">189</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mokong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/mokong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://x.com/morgan2015_wang" target="_blank" title="Twitter"><i class="fab fa-X"></i></a><a class="social-icon" href="mailto:mokong.2015.1992@email.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#iOS-Widget"><span class="toc-number">1.</span> <span class="toc-text">iOS Widget</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">èƒŒæ™¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91"><span class="toc-number">1.2.</span> <span class="toc-text">å¼€å‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-Widget"><span class="toc-number">1.2.1.</span> <span class="toc-text">åˆ›å»º Widget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QQ-%E5%90%8C%E6%AD%A5%E5%8A%A9%E6%89%8B%E7%9A%84-Widget"><span class="toc-number">1.2.2.</span> <span class="toc-text">QQ åŒæ­¥åŠ©æ‰‹çš„ Widget</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WidgetUI-%E5%88%9B%E5%BB%BA"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">WidgetUI åˆ›å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%90%8Cwidget-%E5%B0%BA%E5%AF%B8%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">ä¸åŒwidget å°ºå¯¸è®¾ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#widget-%E6%97%A5%E6%9C%9F%E6%9B%B4%E6%96%B0"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">widget æ—¥æœŸæ›´æ–°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#widget-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E9%80%BB%E8%BE%91"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">widget ç½‘ç»œæ•°æ®é€»è¾‘</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">1.3.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/22/Google%20Antigravity%20%E7%99%BB%E5%BD%95%E4%B8%8D%E4%BA%86%E8%A7%A3%E5%86%B3/" title="Google Antigravity ç™»å½•ä¸äº†è§£å†³">Google Antigravity ç™»å½•ä¸äº†è§£å†³</a><time datetime="2026-01-22T02:38:00.000Z" title="å‘è¡¨äº 2026-01-22 10:38:00">2026-01-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/%E8%BF%9E%E5%A4%9C%E5%BC%80%E5%8F%91%E4%BA%86%E4%B8%80%E4%B8%AA%20Mac%20%E4%B8%8A%E4%B9%85%E5%9D%90%E6%8F%90%E9%86%92%E5%B7%A5%E5%85%B7/" title="è¿å¤œå¼€å‘äº†ä¸€ä¸ª Mac ä¸Šä¹…åæé†’å·¥å…·">è¿å¤œå¼€å‘äº†ä¸€ä¸ª Mac ä¸Šä¹…åæé†’å·¥å…·</a><time datetime="2026-01-21T13:45:00.000Z" title="å‘è¡¨äº 2026-01-21 21:45:00">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/20/%E5%85%B3%E4%BA%8E%20AI%20%E4%B8%8E%E5%BC%80%E5%8F%91/" title="å…³äº AI ä¸å¼€å‘">å…³äº AI ä¸å¼€å‘</a><time datetime="2026-01-20T11:41:00.000Z" title="å‘è¡¨äº 2026-01-20 19:41:00">2026-01-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/16/%E5%88%B6%E4%BD%9C%E8%87%AA%E5%B7%B1%E8%A1%A8%E6%83%85%E5%8C%85/" title="åˆ¶ä½œè‡ªå·±è¡¨æƒ…åŒ…">åˆ¶ä½œè‡ªå·±è¡¨æƒ…åŒ…</a><time datetime="2026-01-16T02:21:00.000Z" title="å‘è¡¨äº 2026-01-16 10:21:00">2026-01-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/13/%E9%B8%BF%E8%92%99%E6%88%AA%E5%9B%BE%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="é¸¿è’™æˆªå›¾ç”Ÿæˆå·¥å…·">é¸¿è’™æˆªå›¾ç”Ÿæˆå·¥å…·</a><time datetime="2025-10-13T07:24:00.000Z" title="å‘è¡¨äº 2025-10-13 15:24:00">2025-10-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2026 By ä»Šæ˜¯æ˜¨é</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div><div class="footer_custom_text"><span>æ—¥å‡ºæ±ŸèŠ±çº¢èƒœç«ï¼Œæ˜¥æ¥æ±Ÿæ°´ç»¿å¦‚è“ï¼Œèƒ½ä¸å¿†æ±Ÿå—</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>